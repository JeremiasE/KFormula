<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>KD Chart 2: KDChartChart.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>KDChartChart.cpp</h1><a href="_k_d_chart_chart_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/****************************************************************************</span>
00002 <span class="comment"> ** Copyright (C) 2006 Klarï¿½vdalens Datakonsult AB.  All rights reserved.</span>
00003 <span class="comment"> **</span>
00004 <span class="comment"> ** This file is part of the KD Chart library.</span>
00005 <span class="comment"> **</span>
00006 <span class="comment"> ** This file may be distributed and/or modified under the terms of the</span>
00007 <span class="comment"> ** GNU General Public License version 2 as published by the Free Software</span>
00008 <span class="comment"> ** Foundation and appearing in the file LICENSE.GPL included in the</span>
00009 <span class="comment"> ** packaging of this file.</span>
00010 <span class="comment"> **</span>
00011 <span class="comment"> ** Licensees holding valid commercial KD Chart licenses may use this file in</span>
00012 <span class="comment"> ** accordance with the KD Chart Commercial License Agreement provided with</span>
00013 <span class="comment"> ** the Software.</span>
00014 <span class="comment"> **</span>
00015 <span class="comment"> ** This file is provided AS IS with NO WARRANTY OF ANY KIND, INCLUDING THE</span>
00016 <span class="comment"> ** WARRANTY OF DESIGN, MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.</span>
00017 <span class="comment"> **</span>
00018 <span class="comment"> ** See http://www.kdab.net/kdchart for</span>
00019 <span class="comment"> **   information about KDChart Commercial License Agreements.</span>
00020 <span class="comment"> **</span>
00021 <span class="comment"> ** Contact info@kdab.net if any conditions of this</span>
00022 <span class="comment"> ** licensing are not clear to you.</span>
00023 <span class="comment"> **</span>
00024 <span class="comment"> **********************************************************************/</span>
00025 
00026 <span class="preprocessor">#include &lt;QList&gt;</span>
00027 <span class="preprocessor">#include &lt;QtDebug&gt;</span>
00028 <span class="preprocessor">#include &lt;QGridLayout&gt;</span>
00029 <span class="preprocessor">#include &lt;QLabel&gt;</span>
00030 <span class="preprocessor">#include &lt;QHash&gt;</span>
00031 
00032 <span class="preprocessor">#include &lt;QPainter&gt;</span>
00033 <span class="preprocessor">#include &lt;QPaintEvent&gt;</span>
00034 <span class="preprocessor">#include &lt;QLayoutItem&gt;</span>
00035 <span class="preprocessor">#include &lt;QPushButton&gt;</span>
00036 <span class="preprocessor">#include &lt;QApplication&gt;</span>
00037 <span class="preprocessor">#include &lt;QEvent&gt;</span>
00038 
00039 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_chart_8h.html">KDChartChart.h</a>"</span>
00040 <span class="preprocessor">#include "KDChartChart_p.h"</span>
00041 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_cartesian_coordinate_plane_8h.html">KDChartCartesianCoordinatePlane.h</a>"</span>
00042 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_abstract_cartesian_diagram_8h.html">KDChartAbstractCartesianDiagram.h</a>"</span>
00043 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_header_footer_8h.html">KDChartHeaderFooter.h</a>"</span>
00044 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_enums_8h.html">KDChartEnums.h</a>"</span>
00045 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_legend_8h.html">KDChartLegend.h</a>"</span>
00046 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_layout_items_8h.html">KDChartLayoutItems.h</a>"</span>
00047 <span class="preprocessor">#include &lt;<a class="code" href="_k_d_chart_text_attributes_8h.html">KDChartTextAttributes.h</a>&gt;</span>
00048 <span class="preprocessor">#include &lt;KDChartMarkerAttributes&gt;</span>
00049 <span class="preprocessor">#include "KDChartPainterSaver_p.h"</span>
00050 
00051 <span class="preprocessor">#if defined KDAB_EVAL</span>
00052 <span class="preprocessor"></span><span class="preprocessor">#include "../evaldialog/evaldialog.h"</span>
00053 <span class="preprocessor">#endif</span>
00054 <span class="preprocessor"></span>
00055 <span class="preprocessor">#include &lt;KDABLibFakes&gt;</span>
00056 
<a name="l00057"></a><a class="code" href="_k_d_chart_chart_8cpp.html#a0">00057</a> <span class="preprocessor">#define SET_ALL_MARGINS_TO_ZERO</span>
00058 <span class="preprocessor"></span>
00059 <span class="comment">// Layout widgets even if they are not visible</span>
00060 <span class="keyword">class </span>MyWidgetItem : <span class="keyword">public</span> QWidgetItem
00061 {
00062 <span class="keyword">public</span>:
00063     <span class="keyword">explicit</span> MyWidgetItem(<a class="code" href="class_q_widget.html">QWidget</a> *w, Qt::Alignment alignment = 0)
00064         : QWidgetItem(w) {
00065         setAlignment( alignment );
00066     }
00067     <span class="comment">/*reimp*/</span> <span class="keywordtype">bool</span> isEmpty()<span class="keyword"> const </span>{
00068         <a class="code" href="class_q_widget.html">QWidget</a>* w = const_cast&lt;MyWidgetItem *&gt;(<span class="keyword">this</span>)-&gt;widget();
00069         <span class="comment">// legend-&gt;hide() should indeed hide the legend,</span>
00070         <span class="comment">// but a legend in a chart that hasn't been shown yet isn't hidden</span>
00071         <span class="comment">// (as can happen when using Chart::paint() without showing the chart)</span>
00072         <span class="keywordflow">return</span> w-&gt;isHidden() &amp;&amp; w-&gt;testAttribute(Qt::WA_WState_ExplicitShowHide);
00073     }
00074 };
00075 
00076 <span class="keyword">using</span> <span class="keyword">namespace </span>KDChart;
00077 
00078 <span class="keywordtype">void</span> Chart::Private::slotUnregisterDestroyedLegend( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a> *l )
00079 {
00080     legends.removeAll( l );
00081     slotRelayout();
00082 }
00083 
00084 <span class="keywordtype">void</span> Chart::Private::slotUnregisterDestroyedHeaderFooter( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* hf )
00085 {
00086     headerFooters.removeAll( hf );
00087     hf-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html#_k_d_chart_1_1_vertical_line_layout_itema9">removeFromParentLayout</a>();
00088     textLayoutItems.remove( textLayoutItems.indexOf( hf ) );
00089     slotRelayout();
00090 }
00091 
00092 <span class="keywordtype">void</span> Chart::Private::slotUnregisterDestroyedPlane( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* plane )
00093 {
00094     coordinatePlanes.removeAll( plane );
00095     Q_FOREACH ( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* p, coordinatePlanes )
00096     {
00097         <span class="keywordflow">if</span> ( p-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea40">referenceCoordinatePlane</a>() == plane) {
00098             p-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea55">setReferenceCoordinatePlane</a>(0);
00099         }
00100     }
00101     plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea19">layoutPlanes</a>();
00102 }
00103 
00104 Chart::Private::Private( <a class="code" href="class_k_d_chart_1_1_chart.html">Chart</a>* chart_ )
00105     : chart( chart_ )
00106     , layout( 0 )
00107     , vLayout( 0 )
00108     , planesLayout( 0 )
00109     , headerLayout( 0 )
00110     , footerLayout( 0 )
00111     , dataAndLegendLayout( 0 )
00112     , globalLeadingLeft( 0 )
00113     , globalLeadingRight( 0 )
00114     , globalLeadingTop( 0 )
00115     , globalLeadingBottom( 0 )
00116 {
00117     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> row = 0; row &lt; 3; ++row )
00118     {
00119         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> column = 0; column &lt; 3; ++column )
00120         {
00121             dummyHeaders[ row ][ column ] = <a class="code" href="class_k_d_chart_1_1_horizontal_line_layout_item.html">HorizontalLineLayoutItem</a>();
00122             dummyFooters[ row ][ column ] = HorizontalLineLayoutItem();
00123         }
00124     }
00125 }
00126 
00127 Chart::Private::~Private()
00128 {
00129     removeDummyHeaderFooters();
00130 }
00131 
00132 <span class="keywordtype">void</span> Chart::Private::removeDummyHeaderFooters()
00133 {
00134     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> row = 0; row &lt; 3; ++row )
00135         {
00136         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> column = 0; column &lt; 3; ++ column )
00137         {
00138             <span class="keywordflow">if</span>( headerLayout != 0 )
00139                 headerLayout-&gt;removeItem( &amp;(dummyHeaders[ row ][ column ]) );
00140             <span class="keywordflow">if</span>( footerLayout != 0 )
00141                 footerLayout-&gt;removeItem( &amp;(dummyFooters[ row ][ column ]) );
00142         }
00143     }
00144 }
00145 
00146 <span class="keywordtype">void</span> Chart::Private::layoutHeadersAndFooters()
00147 {
00148     removeDummyHeaderFooters();
00149 
00150     <span class="keywordtype">bool</span> headersLineFilled[] = { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> };
00151     <span class="keywordtype">bool</span> footersLineFilled[] = { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> };
00152 
00153     Q_FOREACH( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a> *hf, headerFooters ) {
00154         <span class="comment">// for now, there are only two types of Header/Footer,</span>
00155         <span class="comment">// we use a pointer to the right layout, depending on the type():</span>
00156         QGridLayout * headerFooterLayout;
00157         <span class="keywordflow">switch</span>( hf-&gt;<a class="code" href="class_k_d_chart_1_1_header_footer.html#_k_d_chart_1_1_header_footera43">type</a>() ){
00158             <span class="keywordflow">case</span> HeaderFooter::Header:
00159                 headerFooterLayout = headerLayout;
00160                 <span class="keywordflow">break</span>;
00161             <span class="keywordflow">case</span> HeaderFooter::Footer:
00162                 headerFooterLayout = footerLayout;
00163                 <span class="keywordflow">break</span>;
00164             <span class="keywordflow">default</span>:
00165                 Q_ASSERT( <span class="keyword">false</span> ); <span class="comment">// all types need to be handled</span>
00166                 <span class="keywordflow">break</span>;
00167         };
00168 
00169         <span class="keywordflow">if</span>( hf-&gt;<a class="code" href="class_k_d_chart_1_1_header_footer.html#_k_d_chart_1_1_header_footera23">position</a>() != Position::Unknown ) {
00170             <span class="keywordtype">int</span> row, column;
00171             Qt::Alignment hAlign, vAlign;
00172             <span class="keywordflow">if</span>( hf-&gt;<a class="code" href="class_k_d_chart_1_1_header_footer.html#_k_d_chart_1_1_header_footera23">position</a>().<a class="code" href="class_k_d_chart_1_1_position.html#_k_d_chart_1_1_positiona3">isNorthSide</a>() ){
00173                 row = 0;
00174                 vAlign = Qt::AlignTop;
00175             }
00176             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( hf-&gt;<a class="code" href="class_k_d_chart_1_1_header_footer.html#_k_d_chart_1_1_header_footera23">position</a>().<a class="code" href="class_k_d_chart_1_1_position.html#_k_d_chart_1_1_positiona5">isSouthSide</a>() ){
00177                 row = 2;
00178                 vAlign = Qt::AlignBottom;
00179             }
00180             <span class="keywordflow">else</span>{
00181                 row = 1;
00182                 vAlign = Qt::AlignVCenter;
00183             }
00184             <span class="keywordflow">if</span>( hf-&gt;<a class="code" href="class_k_d_chart_1_1_header_footer.html#_k_d_chart_1_1_header_footera23">position</a>().<a class="code" href="class_k_d_chart_1_1_position.html#_k_d_chart_1_1_positiona7">isWestSide</a>() ){
00185                 column = 0;
00186                 hAlign = Qt::AlignLeft;
00187             }
00188             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( hf-&gt;<a class="code" href="class_k_d_chart_1_1_header_footer.html#_k_d_chart_1_1_header_footera23">position</a>().<a class="code" href="class_k_d_chart_1_1_position.html#_k_d_chart_1_1_positiona1">isEastSide</a>() ){
00189                 column = 2;
00190                 hAlign = Qt::AlignRight;
00191             }
00192             <span class="keywordflow">else</span>{
00193                 column = 1;
00194                 hAlign = Qt::AlignHCenter;
00195             }
00196             <span class="keywordflow">switch</span>( hf-&gt;<a class="code" href="class_k_d_chart_1_1_header_footer.html#_k_d_chart_1_1_header_footera43">type</a>() ){
00197                 <span class="keywordflow">case</span> HeaderFooter::Header:
00198                     <span class="keywordflow">if</span>( !headersLineFilled[ row ] )
00199                     {
00200                         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> col = 0; col &lt; 3; ++col )
00201                             headerFooterLayout-&gt;addItem( &amp;(dummyHeaders[ row ][ col ]), row, col );
00202                         headersLineFilled[ row ] = <span class="keyword">true</span>;
00203                     }
00204                     <span class="keywordflow">break</span>;
00205                 <span class="keywordflow">case</span> HeaderFooter::Footer:
00206                     <span class="keywordflow">if</span>( !footersLineFilled[ row ] )
00207                     {
00208                         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> col = 0; col &lt; 3; ++col )
00209                             headerFooterLayout-&gt;addItem( &amp;(dummyFooters[ row ][ col ]), row, col );
00210                         footersLineFilled[ row ] = <span class="keyword">true</span>;
00211                     }
00212                     <span class="keywordflow">break</span>;
00213             };
00214             textLayoutItems &lt;&lt; hf;
00215             hf-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html#_k_d_chart_1_1_vertical_line_layout_itema11">setParentLayout</a>( headerFooterLayout );
00216             headerFooterLayout-&gt;addItem( hf, row, column, 1, 1, hAlign | vAlign );
00217         }
00218         <span class="keywordflow">else</span>{
00219             qDebug( <span class="stringliteral">"Unknown header/footer position"</span> );
00220         }
00221     }
00222 }
00223 
00224 
00225 <span class="keywordtype">void</span> Chart::Private::layoutLegends()
00226 {
00227     <span class="comment">// To support more than one Legend, we first collect them all</span>
00228     <span class="comment">// in little lists: one list per grid position.</span>
00229     <span class="comment">// Since the dataAndLegendLayout is a 3x3 grid, we need 9 little lists.</span>
00230     QList&lt;Legend*&gt; infos[3][3];
00231 
00232     Q_FOREACH( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a> *legend, legends ) {
00233 
00234         legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda25">needSizeHint</a>(); <span class="comment">// we'll lay it out soon</span>
00235 
00236         <span class="keywordtype">bool</span> bOK = <span class="keyword">true</span>;
00237         <span class="keywordtype">int</span> row, column;
00238         <span class="keywordflow">switch</span>( legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda35">position</a>().<a class="code" href="class_k_d_chart_1_1_position.html#_k_d_chart_1_1_positiona16">value</a>() ) {
00239             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw28">KDChartEnums::PositionNorthWest</a>:  row = 0;  column = 0;
00240                 <span class="keywordflow">break</span>;
00241             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw26">KDChartEnums::PositionNorth</a>:      row = 0;  column = 1;
00242                 <span class="keywordflow">break</span>;
00243             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw27">KDChartEnums::PositionNorthEast</a>:  row = 0;  column = 2;
00244                 <span class="keywordflow">break</span>;
00245             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw24">KDChartEnums::PositionEast</a>:       row = 1;  column = 2;
00246                 <span class="keywordflow">break</span>;
00247             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw30">KDChartEnums::PositionSouthEast</a>:  row = 2;  column = 2;
00248                 <span class="keywordflow">break</span>;
00249             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw29">KDChartEnums::PositionSouth</a>:      row = 2;  column = 1;
00250                 <span class="keywordflow">break</span>;
00251             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw31">KDChartEnums::PositionSouthWest</a>:  row = 2;  column = 0;
00252                 <span class="keywordflow">break</span>;
00253             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw34">KDChartEnums::PositionWest</a>:       row = 1;  column = 0;
00254                 <span class="keywordflow">break</span>;
00255             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw23">KDChartEnums::PositionCenter</a>:
00256                 qDebug( <span class="stringliteral">"Sorry: Legend not shown, because position Center is not supported."</span> );
00257                 bOK = <span class="keyword">false</span>;
00258                 <span class="keywordflow">break</span>;
00259             <span class="keywordflow">case</span> <a class="code" href="class_k_d_chart_enums.html#_k_d_chart_enumsw33_k_d_chart_enumsw25">KDChartEnums::PositionFloating</a>:
00260                 bOK = <span class="keyword">false</span>;
00261                 <span class="keywordflow">break</span>;
00262             <span class="keywordflow">default</span>:
00263                 qDebug( <span class="stringliteral">"Sorry: Legend not shown, because of unknown legend position."</span> );
00264                 bOK = <span class="keyword">false</span>;
00265                 <span class="keywordflow">break</span>;
00266         }
00267         <span class="keywordflow">if</span>( bOK )
00268             infos[row][column] &lt;&lt; legend;
00269     }
00270     <span class="comment">// We have collected all legend information,</span>
00271     <span class="comment">// so we can design their layout now.</span>
00272     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iR = 0; iR &lt; 3; ++iR) {
00273         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iC = 0; iC &lt; 3; ++iC) {
00274             QList&lt;Legend*&gt;&amp; list = infos[iR][iC];
00275             <span class="keyword">const</span> <span class="keywordtype">int</span> count = list.size();
00276             <span class="keywordflow">switch</span>( count ){
00277             <span class="keywordflow">case</span> 0:
00278                 <span class="keywordflow">break</span>;
00279             <span class="keywordflow">case</span> 1: {
00280                     <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* legend = list.first();
00281                     dataAndLegendLayout-&gt;addItem( <span class="keyword">new</span> MyWidgetItem(legend),
00282                         iR, iC, 1, 1, legend-&gt;alignment() );
00283             }
00284                 <span class="keywordflow">break</span>;
00285             <span class="keywordflow">default</span>: {
00286                     <span class="comment">// We have more than one legend in the same cell</span>
00287                     <span class="comment">// of the big dataAndLegendLayout grid.</span>
00288                     <span class="comment">//</span>
00289                     <span class="comment">// So we need to find out, if they are aligned the</span>
00290                     <span class="comment">// same way:</span>
00291                     <span class="comment">// Those legends, that are aligned the same way, will be drawn</span>
00292                     <span class="comment">// leftbound, on top of each other, in a little VBoxLayout.</span>
00293                     <span class="comment">//</span>
00294                     <span class="comment">// If not al of the legends are aligned the same way,</span>
00295                     <span class="comment">// there will be a grid with 3 cells: for left/mid/right side</span>
00296                     <span class="comment">// (or top/mid/bottom side, resp.) legends</span>
00297                     <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* legend = list.first();
00298                     Qt::Alignment alignment = legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda2">alignment</a>();
00299                     <span class="keywordtype">bool</span> haveSameAlign = <span class="keyword">true</span>;
00300                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; count; ++i) {
00301                         legend = list.at(i);
00302                         <span class="keywordflow">if</span>( alignment != legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda2">alignment</a>() ){
00303                             haveSameAlign = <span class="keyword">false</span>;
00304                             <span class="keywordflow">break</span>;
00305                         }
00306                     }
00307                     <span class="keywordflow">if</span>( haveSameAlign ){
00308                         QVBoxLayout* vLayout = <span class="keyword">new</span> QVBoxLayout();
00309                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; ++i) {
00310                             vLayout-&gt;addItem( <span class="keyword">new</span> MyWidgetItem(list.at(i), Qt::AlignLeft) );
00311                         }
00312                         dataAndLegendLayout-&gt;addLayout( vLayout, iR, iC, 1, 1, alignment );
00313                     }<span class="keywordflow">else</span>{
00314                         QGridLayout* gridLayout = <span class="keyword">new</span> QGridLayout();
00315 <span class="preprocessor">#define ADD_VBOX_WITH_LEGENDS(row, column, align) \</span>
00316 <span class="preprocessor">{ \</span>
00317 <span class="preprocessor">    QVBoxLayout* innerLayout = new QVBoxLayout(); \</span>
00318 <span class="preprocessor">    for (int i = 0; i &lt; count; ++i) { \</span>
00319 <span class="preprocessor">        legend = list.at(i); \</span>
00320 <span class="preprocessor">        if( legend-&gt;alignment() == ( align ) ) \</span>
00321 <span class="preprocessor">            innerLayout-&gt;addItem( new MyWidgetItem(legend, Qt::AlignLeft) ); \</span>
00322 <span class="preprocessor">    } \</span>
00323 <span class="preprocessor">    gridLayout-&gt;addLayout( innerLayout, row, column, ( align  ) ); \</span>
00324 <span class="preprocessor">}</span>
00325 <span class="preprocessor"></span>                        <a class="code" href="_k_d_chart_chart_8cpp.html#a1">ADD_VBOX_WITH_LEGENDS</a>( 0, 0, Qt::AlignTop     | Qt::AlignLeft )
00326                         <a class="code" href="_k_d_chart_chart_8cpp.html#a1">ADD_VBOX_WITH_LEGENDS</a>( 0, 1, Qt::AlignTop     | Qt::AlignHCenter )
00327                         <a class="code" href="_k_d_chart_chart_8cpp.html#a1">ADD_VBOX_WITH_LEGENDS</a>( 0, 2, Qt::AlignTop     | Qt::AlignRight )
00328 
00329                         <a class="code" href="_k_d_chart_chart_8cpp.html#a1">ADD_VBOX_WITH_LEGENDS</a>( 1, 0, Qt::AlignVCenter | Qt::AlignLeft )
00330                         <a class="code" href="_k_d_chart_chart_8cpp.html#a1">ADD_VBOX_WITH_LEGENDS</a>( 1, 2, Qt::AlignVCenter | Qt::AlignRight )
00331 
00332                         <a class="code" href="_k_d_chart_chart_8cpp.html#a1">ADD_VBOX_WITH_LEGENDS</a>( 2, 0, Qt::AlignBottom  | Qt::AlignLeft )
00333                         <a class="code" href="_k_d_chart_chart_8cpp.html#a1">ADD_VBOX_WITH_LEGENDS</a>( 2, 1, Qt::AlignBottom  | Qt::AlignHCenter )
00334                         <a class="code" href="_k_d_chart_chart_8cpp.html#a1">ADD_VBOX_WITH_LEGENDS</a>( 2, 2, Qt::AlignBottom  | Qt::AlignRight )
00335 
00336                         dataAndLegendLayout-&gt;addLayout( gridLayout, iR, iC, 1, 1 );
00337                     }
00338                 }
00339             }
00340         }
00341     }
00342 }
00343 
00344 
00345 QHash&lt;AbstractCoordinatePlane*, PlaneInfo&gt; Chart::Private::buildPlaneLayoutInfos()
00346 {
00347     <span class="comment">/* There are two ways in which planes can be caused to interact in</span>
00348 <span class="comment">     * where they are put layouting wise: The first is the reference plane. If</span>
00349 <span class="comment">     * such a reference plane is set, on a plane, it will use the same cell in the</span>
00350 <span class="comment">     * layout as that one. In addition to this, planes can share an axis. In that case</span>
00351 <span class="comment">     * they will be layed out in relation to each other as suggested by the position</span>
00352 <span class="comment">     * of the axis. If, for example Plane1 and Plane2 share an axis at position Left,</span>
00353 <span class="comment">     * that will result in the layout: Axis Plane1 Plane 2, vertically. If Plane1</span>
00354 <span class="comment">     * also happens to be Plane2's referece plane, both planes are drawn over each</span>
00355 <span class="comment">     * other. The reference plane concept allows two planes to share the same space</span>
00356 <span class="comment">     * even if neither has any axis, and in case there are shared axis, it is used</span>
00357 <span class="comment">     * to decided, whether the planes should be painted on top of each other or</span>
00358 <span class="comment">     * layed out vertically or horizontally next to each other. */</span>
00359     QHash&lt;CartesianAxis*, AxisInfo&gt; axisInfos;
00360     QHash&lt;AbstractCoordinatePlane*, PlaneInfo&gt; planeInfos;
00361     Q_FOREACH(<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* plane, coordinatePlanes )
00362     {
00363         PlaneInfo p;
00364         <span class="comment">// first check if we share space with another plane</span>
00365         p.referencePlane = plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea40">referenceCoordinatePlane</a>();
00366         planeInfos.insert( plane, p );
00367 
00368         Q_FOREACH( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* abstractDiagram, plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea8">diagrams</a>() ) {
00369             <a class="code" href="class_k_d_chart_1_1_abstract_cartesian_diagram.html">AbstractCartesianDiagram</a>* diagram =
00370                     dynamic_cast&lt;AbstractCartesianDiagram*&gt; ( abstractDiagram );
00371             <span class="keywordflow">if</span>( !diagram ) <span class="keywordflow">continue</span>;
00372 
00373             Q_FOREACH( <a class="code" href="class_k_d_chart_1_1_cartesian_axis.html">CartesianAxis</a>* axis, diagram-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_cartesian_diagram.html#_k_d_chart_1_1_line_diagrama4">axes</a>() ) {
00374                 <span class="keywordflow">if</span> ( !axisInfos.contains( axis ) ) {
00375                     <span class="comment">/* If this is the first time we see this axis, add it, with the</span>
00376 <span class="comment">                     * current plane. The first plane added to the chart that has</span>
00377 <span class="comment">                     * the axis associated with it thus "owns" it, and decides about</span>
00378 <span class="comment">                     * layout. */</span>
00379                     AxisInfo i;
00380                     i.plane = plane;
00381                     axisInfos.insert( axis, i );
00382                 } <span class="keywordflow">else</span> {
00383                     AxisInfo i = axisInfos[axis];
00384                     <span class="keywordflow">if</span> ( i.plane == plane ) <span class="keywordflow">continue</span>; <span class="comment">// we don't want duplicates, only shared</span>
00385 
00386                     <span class="comment">/* The user expects diagrams to be added on top, and to the right</span>
00387 <span class="comment">                     * so that horizontally we need to move the new diagram, vertically</span>
00388 <span class="comment">                     * the reference one. */</span>
00389                     PlaneInfo pi = planeInfos[plane];
00390                     <span class="comment">// plane-to-plane linking overrides linking via axes</span>
00391                     <span class="keywordflow">if</span> ( !pi.referencePlane ) {
00392                         <span class="comment">// we're not the first plane to see this axis, mark us as a slave</span>
00393                         pi.referencePlane = i.plane;
00394                         <span class="keywordflow">if</span> ( axis-&gt;position() == CartesianAxis::Left
00395                             ||  axis-&gt;position() == CartesianAxis::Right )
00396                             pi.horizontalOffset += 1;
00397                         planeInfos[plane] = pi;
00398 
00399                         pi = planeInfos[i.plane];
00400                         <span class="keywordflow">if</span> ( axis-&gt;position() == CartesianAxis::Top
00401                             || axis-&gt;position() == CartesianAxis::Bottom  )
00402                             pi.verticalOffset += 1;
00403 
00404                         planeInfos[i.plane] = pi;
00405                     }
00406                 }
00407             }
00408         }
00409         <span class="comment">// Create a new grid layout for each plane that has no reference.</span>
00410         p = planeInfos[plane];
00411         <span class="keywordflow">if</span> ( p.referencePlane == 0 ) {
00412             p.gridLayout = <span class="keyword">new</span> QGridLayout();
00413             <span class="comment">// TESTING(khz): set the margin of all of the layouts to Zero</span>
00414 <span class="preprocessor">#if defined SET_ALL_MARGINS_TO_ZERO</span>
00415 <span class="preprocessor"></span>            p.gridLayout-&gt;setMargin(0);
00416 <span class="preprocessor">#endif</span>
00417 <span class="preprocessor"></span>            planeInfos[plane] = p;
00418         }
00419     }
00420     <span class="keywordflow">return</span> planeInfos;
00421 }
00422 
00423 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00424"></a><a class="code" href="_k_d_chart_chart_8cpp.html#a4">00424</a> <span class="keyword">static</span> T* <a class="code" href="_k_d_chart_chart_8cpp.html#a4">findOrCreateLayoutByObjectName</a>( QLayout * parentLayout, <span class="keyword">const</span> <span class="keywordtype">char</span>* name )
00425 {
00426     T *box = qFindChild&lt;T*&gt;( parentLayout, QString::fromLatin1( name ) );
00427     <span class="keywordflow">if</span> ( !box ) {
00428         box = <span class="keyword">new</span> T();
00429         <span class="comment">// TESTING(khz): set the margin of all of the layouts to Zero</span>
00430 <span class="preprocessor">#if defined SET_ALL_MARGINS_TO_ZERO</span>
00431 <span class="preprocessor"></span>        box-&gt;setMargin(0);
00432 <span class="preprocessor">#endif</span>
00433 <span class="preprocessor"></span>        box-&gt;setObjectName( QString::fromLatin1( name ) );
00434         box-&gt;setSizeConstraint( QLayout::SetFixedSize );
00435     }
00436     <span class="keywordflow">return</span> box;
00437 }
00438 
<a name="l00439"></a><a class="code" href="_k_d_chart_chart_8cpp.html#a5">00439</a> <span class="keyword">static</span> QVBoxLayout* <a class="code" href="_k_d_chart_chart_8cpp.html#a5">findOrCreateVBoxLayoutByObjectName</a>( QLayout* parentLayout, <span class="keyword">const</span> <span class="keywordtype">char</span>* name )
00440 {
00441     <span class="keywordflow">return</span> findOrCreateLayoutByObjectName&lt;QVBoxLayout&gt;( parentLayout, name );
00442 }
00443 
<a name="l00444"></a><a class="code" href="_k_d_chart_chart_8cpp.html#a6">00444</a> <span class="keyword">static</span> QHBoxLayout* <a class="code" href="_k_d_chart_chart_8cpp.html#a6">findOrCreateHBoxLayoutByObjectName</a>( QLayout* parentLayout, <span class="keyword">const</span> <span class="keywordtype">char</span>* name )
00445 {
00446     <span class="keywordflow">return</span> findOrCreateLayoutByObjectName&lt;QHBoxLayout&gt;( parentLayout, name );
00447 }
00448 
00449 <span class="keywordtype">void</span> Chart::Private::slotLayoutPlanes()
00450 {
00451     <span class="comment">//qDebug() &lt;&lt; "KDChart::Chart is layouting the planes";</span>
00452     <span class="keyword">const</span> QBoxLayout::Direction oldPlanesDirection =
00453             planesLayout ? planesLayout-&gt;direction() : QBoxLayout::TopToBottom;
00454     <span class="keywordflow">if</span> ( planesLayout &amp;&amp; dataAndLegendLayout )
00455         dataAndLegendLayout-&gt;removeItem( planesLayout );
00456 
00457     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html">KDChart::AbstractLayoutItem</a>* plane, planeLayoutItems ) {
00458         plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html#_k_d_chart_1_1_vertical_line_layout_itema9">removeFromParentLayout</a>();
00459     }
00460     planeLayoutItems.clear();
00461     <span class="keyword">delete</span> planesLayout;
00462     <span class="comment">//hint: The direction is configurable by the user now, as</span>
00463     <span class="comment">//      we are using a QBoxLayout rather than a QVBoxLayout.  (khz, 2007/04/25)</span>
00464     planesLayout = <span class="keyword">new</span> QBoxLayout( oldPlanesDirection );
00465 
00466     <span class="comment">// TESTING(khz): set the margin of all of the layouts to Zero</span>
00467 <span class="preprocessor">#if defined SET_ALL_MARGINS_TO_ZERO</span>
00468 <span class="preprocessor"></span>    planesLayout-&gt;setMargin(0);
00469 <span class="preprocessor">#endif</span>
00470 <span class="preprocessor"></span>    planesLayout-&gt;setObjectName( QString::fromLatin1( <span class="stringliteral">"planesLayout"</span> ) );
00471 
00472     <span class="comment">/* First go through all planes and all axes and figure out whether the planes</span>
00473 <span class="comment">     * need to coordinate. If they do, they share a grid layout, if not, each</span>
00474 <span class="comment">     * get their own. See buildPlaneLayoutInfos() for more details. */</span>
00475     QHash&lt;AbstractCoordinatePlane*, PlaneInfo&gt; planeInfos = buildPlaneLayoutInfos();
00476     QHash&lt;AbstractAxis*, AxisInfo&gt; axisInfos;
00477     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* plane, coordinatePlanes ) {
00478         Q_ASSERT( planeInfos.contains(plane) );
00479         <span class="keyword">const</span> PlaneInfo pi = planeInfos[plane];
00480         <span class="keywordtype">int</span> column = pi.horizontalOffset;
00481         <span class="keywordtype">int</span> row = pi.verticalOffset;
00482         <span class="comment">//qDebug() &lt;&lt; "processing plane at column" &lt;&lt; column &lt;&lt; "and row" &lt;&lt; row;</span>
00483         QGridLayout *planeLayout = pi.gridLayout;
00484         <span class="keywordflow">if</span> ( !planeLayout ) {
00485             <span class="comment">// this plane is sharing an axis with another one, so use</span>
00486             <span class="comment">// the grid of that one as well</span>
00487             planeLayout = planeInfos[pi.referencePlane].gridLayout;
00488         } <span class="keywordflow">else</span> {
00489             planesLayout-&gt;addLayout( planeLayout );
00490         }
00491         Q_ASSERT( planeLayout );
00492         <span class="comment">/* Put the plane in the center of the layout. If this is our own, that's</span>
00493 <span class="comment">         * the middle of the layout, if we are sharing, it's a cell in the center</span>
00494 <span class="comment">         * column of the shared grid. */</span>
00495         planeLayoutItems &lt;&lt; plane;
00496         plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html#_k_d_chart_1_1_vertical_line_layout_itema11">setParentLayout</a>( planeLayout );
00497         planeLayout-&gt;addItem( plane, row, column, 1, 1, 0 );
00498         <span class="comment">//qDebug() &lt;&lt; "Chart slotLayoutPlanes() calls planeLayout-&gt;addItem("&lt;&lt; row &lt;&lt; column &lt;&lt; ")";</span>
00499         planeLayout-&gt;setRowStretch(    row,    2 );
00500         planeLayout-&gt;setColumnStretch( column, 2 );
00501 
00502         <span class="comment">// These four layouts will be instantiated in the following loop,</span>
00503         <span class="comment">// if they are needed.</span>
00504         <span class="comment">// They will then be passed to the auto-spacer items after the loop.</span>
00505         QVBoxLayout *topAxesLayout    = 0;
00506         QVBoxLayout *bottomAxesLayout = 0;
00507         QHBoxLayout *leftAxesLayout   = 0;
00508         QHBoxLayout *rightAxesLayout  = 0;
00509 
00510         KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* abstractDiagram, plane-&gt;diagrams() )
00511         {
00512             <a class="code" href="class_k_d_chart_1_1_abstract_cartesian_diagram.html">AbstractCartesianDiagram</a>* diagram =
00513                     dynamic_cast&lt;AbstractCartesianDiagram*&gt; ( abstractDiagram );
00514             <span class="comment">//qDebug() &lt;&lt; "--------------- diagram ???????????????????? -----------------";</span>
00515             <span class="keywordflow">if</span>( !diagram ) <span class="keywordflow">continue</span>;  <span class="comment">// FIXME polar ?</span>
00516             <span class="comment">//qDebug() &lt;&lt; "--------------- diagram ! ! ! ! ! ! ! ! ! !  -----------------";</span>
00517             <span class="comment">// collect all axes of a kind into sublayouts</span>
00518             <span class="keywordflow">if</span>( ! topAxesLayout )
00519                 topAxesLayout = <a class="code" href="_k_d_chart_chart_8cpp.html#a5">findOrCreateVBoxLayoutByObjectName</a>( planeLayout, <span class="stringliteral">"topAxesLayout"</span> );
00520             <span class="keywordflow">if</span>( ! bottomAxesLayout )
00521                 bottomAxesLayout = <a class="code" href="_k_d_chart_chart_8cpp.html#a5">findOrCreateVBoxLayoutByObjectName</a>( planeLayout, <span class="stringliteral">"bottomAxesLayout"</span> );
00522             <span class="keywordflow">if</span>( ! leftAxesLayout )
00523                 leftAxesLayout = <a class="code" href="_k_d_chart_chart_8cpp.html#a6">findOrCreateHBoxLayoutByObjectName</a>( planeLayout, <span class="stringliteral">"leftAxesLayout"</span> );
00524             <span class="keywordflow">if</span>( ! rightAxesLayout )
00525                 rightAxesLayout = <a class="code" href="_k_d_chart_chart_8cpp.html#a6">findOrCreateHBoxLayoutByObjectName</a>( planeLayout, <span class="stringliteral">"rightAxesLayout"</span> );
00526 
00527             <span class="comment">//leftAxesLayout-&gt;setSizeConstraint( QLayout::SetFixedSize );</span>
00528 
00529             KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_cartesian_axis.html">CartesianAxis</a>* axis, diagram-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_cartesian_diagram.html#_k_d_chart_1_1_line_diagrama4">axes</a>() ) {
00530                 <span class="keywordflow">if</span> ( axisInfos.contains( axis ) ) <span class="keywordflow">continue</span>; <span class="comment">// already layed this one out</span>
00531                 Q_ASSERT ( axis );
00532                 <span class="comment">//qDebug() &lt;&lt; "--------------- axis added to planeLayoutItems  -----------------";</span>
00533                 planeLayoutItems &lt;&lt; axis;
00534                 <span class="comment">/*</span>
00535 <span class="comment">                // Unused code trying to use a push-model: This did not work</span>
00536 <span class="comment">                // since we can not re-layout the planes each time when</span>
00537 <span class="comment">                // Qt layouting is calling sizeHint()</span>
00538 <span class="comment">                connect( axis, SIGNAL( needAdjustLeftRightColumnsForOverlappingLabels(</span>
00539 <span class="comment">                                CartesianAxis*, int, int ) ),</span>
00540 <span class="comment">                         this, SLOT( slotAdjustLeftRightColumnsForOverlappingLabels(</span>
00541 <span class="comment">                                 CartesianAxis*, int, int ) ) );</span>
00542 <span class="comment">                connect( axis, SIGNAL( needAdjustTopBottomRowsForOverlappingLabels(</span>
00543 <span class="comment">                                CartesianAxis*, int, int ) ),</span>
00544 <span class="comment">                         this, SLOT( slotAdjustTopBottomRowsForOverlappingLabels(</span>
00545 <span class="comment">                                 CartesianAxis*, int, int ) ) );</span>
00546 <span class="comment">                */</span>
00547                 <span class="keywordflow">switch</span> ( axis-&gt;position() )
00548                 {
00549                     <span class="keywordflow">case</span> CartesianAxis::Top:
00550                         axis-&gt;setParentLayout( topAxesLayout );
00551                         topAxesLayout-&gt;addItem( axis );
00552                         <span class="keywordflow">break</span>;
00553                     <span class="keywordflow">case</span> CartesianAxis::Bottom:
00554                         axis-&gt;setParentLayout( bottomAxesLayout );
00555                         bottomAxesLayout-&gt;addItem( axis );
00556                         <span class="keywordflow">break</span>;
00557                     <span class="keywordflow">case</span> CartesianAxis::Left:
00558                         axis-&gt;setParentLayout( leftAxesLayout );
00559                         leftAxesLayout-&gt;addItem( axis );
00560                         <span class="keywordflow">break</span>;
00561                     <span class="keywordflow">case</span> CartesianAxis::Right:
00562                         axis-&gt;setParentLayout( rightAxesLayout );
00563                         rightAxesLayout-&gt;addItem( axis );
00564                         <span class="keywordflow">break</span>;
00565                     <span class="keywordflow">default</span>:
00566                         Q_ASSERT_X( <span class="keyword">false</span>, <span class="stringliteral">"Chart::paintEvent"</span>,
00567                                     <span class="stringliteral">"unknown axis position"</span> );
00568                         <span class="keywordflow">break</span>;
00569                 };
00570                 axisInfos.insert( axis, AxisInfo() );
00571             }
00572             <span class="comment">/* Put each stack of axes-layouts in the cells surrounding the</span>
00573 <span class="comment">             * associated plane. We are laying out in the oder the planes</span>
00574 <span class="comment">             * were added, and the first one gets to lay out shared axes.</span>
00575 <span class="comment">             * Private axes go here as well, of course. */</span>
00576             <span class="keywordflow">if</span> ( !topAxesLayout-&gt;parent() )
00577                 planeLayout-&gt;addLayout( topAxesLayout,    row - 1, column );
00578             <span class="keywordflow">if</span> ( !bottomAxesLayout-&gt;parent() )
00579                 planeLayout-&gt;addLayout( bottomAxesLayout, row + 1, column );
00580             <span class="keywordflow">if</span> ( !leftAxesLayout-&gt;parent() ){
00581                 planeLayout-&gt;addLayout( leftAxesLayout,   row,     column - 1);
00582                 <span class="comment">//planeLayout-&gt;setRowStretch(    row, 0 );</span>
00583                 <span class="comment">//planeLayout-&gt;setColumnStretch( 0,   0 );</span>
00584             }
00585             <span class="keywordflow">if</span> ( !rightAxesLayout-&gt;parent() )
00586                 planeLayout-&gt;addLayout( rightAxesLayout,  row,     column + 1);
00587         }
00588 
00589         <span class="comment">// use up to four auto-spacer items in the corners around the diagrams:</span>
00590 <span class="preprocessor">#define ADD_AUTO_SPACER_IF_NEEDED( \</span>
00591 <span class="preprocessor">    spacerRow, spacerColumn, hLayoutIsAtTop, hLayout, vLayoutIsAtLeft, vLayout ) \</span>
00592 <span class="preprocessor">{ \</span>
00593 <span class="preprocessor">    if( hLayout || vLayout ) { \</span>
00594 <span class="preprocessor">        AutoSpacerLayoutItem * spacer \</span>
00595 <span class="preprocessor">                = new AutoSpacerLayoutItem( hLayoutIsAtTop, hLayout, vLayoutIsAtLeft, vLayout ); \</span>
00596 <span class="preprocessor">        planeLayout-&gt;addItem( spacer, spacerRow, spacerColumn, 1, 1 ); \</span>
00597 <span class="preprocessor">        spacer-&gt;setParentLayout( planeLayout ); \</span>
00598 <span class="preprocessor">        planeLayoutItems &lt;&lt; spacer; \</span>
00599 <span class="preprocessor">    } \</span>
00600 <span class="preprocessor">}</span>
00601 <span class="preprocessor"></span>        <a class="code" href="_k_d_chart_chart_8cpp.html#a2">ADD_AUTO_SPACER_IF_NEEDED</a>( row-1, column-1, <span class="keyword">false</span>, leftAxesLayout,  <span class="keyword">false</span>, topAxesLayout )
00602         <a class="code" href="_k_d_chart_chart_8cpp.html#a2">ADD_AUTO_SPACER_IF_NEEDED</a>( row+1, column-1, <span class="keyword">true</span>,  leftAxesLayout,  <span class="keyword">false</span>,  bottomAxesLayout )
00603         <a class="code" href="_k_d_chart_chart_8cpp.html#a2">ADD_AUTO_SPACER_IF_NEEDED</a>( row-1, column+1, <span class="keyword">false</span>, rightAxesLayout, <span class="keyword">true</span>, topAxesLayout )
00604         <a class="code" href="_k_d_chart_chart_8cpp.html#a2">ADD_AUTO_SPACER_IF_NEEDED</a>( row+1, column+1, <span class="keyword">true</span>,  rightAxesLayout, <span class="keyword">true</span>,  bottomAxesLayout )
00605     }
00606     <span class="comment">// re-add our grid(s) to the chart's layout</span>
00607     <span class="keywordflow">if</span> ( dataAndLegendLayout ){
00608         dataAndLegendLayout-&gt;addLayout( planesLayout, 1, 1 );
00609         dataAndLegendLayout-&gt;setRowStretch(    1, 1000 );
00610         dataAndLegendLayout-&gt;setColumnStretch( 1, 1000 );
00611     }
00612 
00613     slotRelayout();
00614     <span class="comment">//qDebug() &lt;&lt; "KDChart::Chart finished layouting the planes.";</span>
00615 }
00616 
00617 <span class="keywordtype">void</span> Chart::Private::createLayouts( <a class="code" href="class_q_widget.html">QWidget</a>* w )
00618 {
00619     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_text_area.html">KDChart::TextArea</a>* textLayoutItem, textLayoutItems ) {
00620         textLayoutItem-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html#_k_d_chart_1_1_vertical_line_layout_itema9">removeFromParentLayout</a>();
00621     }
00622     textLayoutItems.clear();
00623 
00624     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_abstract_area.html">KDChart::AbstractArea</a>* layoutItem, layoutItems ) {
00625         layoutItem-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html#_k_d_chart_1_1_vertical_line_layout_itema9">removeFromParentLayout</a>();
00626     }
00627     layoutItems.clear();
00628 
00629     removeDummyHeaderFooters();
00630 
00631     <span class="comment">// layout for the planes is handled separately, so we don't want to delete it here</span>
00632     <span class="keywordflow">if</span> ( dataAndLegendLayout) {
00633         dataAndLegendLayout-&gt;removeItem( planesLayout );
00634         planesLayout-&gt;setParent( 0 );
00635     }
00636     <span class="comment">// nuke the old bunch</span>
00637     <span class="keyword">delete</span> layout;
00638 
00639     <span class="comment">// The HBox d-&gt;layout provides the left and right global leadings</span>
00640     layout = <span class="keyword">new</span> QHBoxLayout( w );
00641     <span class="comment">// TESTING(khz): set the margin of all of the layouts to Zero</span>
00642 <span class="preprocessor">#if defined SET_ALL_MARGINS_TO_ZERO</span>
00643 <span class="preprocessor"></span>    layout-&gt;setMargin(0);
00644 <span class="preprocessor">#endif</span>
00645 <span class="preprocessor"></span>    layout-&gt;setObjectName( QString::fromLatin1( <span class="stringliteral">"Chart::Private::layout"</span> ) );
00646     layout-&gt;addSpacing( globalLeadingLeft );
00647 
00648     <span class="comment">// The vLayout provides top and bottom global leadings and lays</span>
00649     <span class="comment">// out headers/footers and the data area.</span>
00650     vLayout = <span class="keyword">new</span> QVBoxLayout();
00651     <span class="comment">// TESTING(khz): set the margin of all of the layouts to Zero</span>
00652 <span class="preprocessor">#if defined SET_ALL_MARGINS_TO_ZERO</span>
00653 <span class="preprocessor"></span>    vLayout-&gt;setMargin(0);
00654 <span class="preprocessor">#endif</span>
00655 <span class="preprocessor"></span>    vLayout-&gt;setObjectName( QString::fromLatin1( <span class="stringliteral">"vLayout"</span> ) );
00656     layout-&gt;addLayout( vLayout, 1000 );
00657     layout-&gt;addSpacing( globalLeadingRight );
00658 
00659 
00660 
00661     <span class="comment">// 1. the gap above the top edge of the headers area</span>
00662     vLayout-&gt;addSpacing( globalLeadingTop );
00663     <span class="comment">// 2. the header(s) area</span>
00664     headerLayout = <span class="keyword">new</span> QGridLayout();
00665     <span class="comment">// TESTING(khz): set the margin of all of the layouts to Zero</span>
00666 <span class="preprocessor">#if defined SET_ALL_MARGINS_TO_ZERO</span>
00667 <span class="preprocessor"></span>    headerLayout-&gt;setMargin(0);
00668 <span class="preprocessor">#endif</span>
00669 <span class="preprocessor"></span>    vLayout-&gt;addLayout( headerLayout );
00670     <span class="comment">// 3. the area containing coordinate plane(s), axes, legend(s)</span>
00671     dataAndLegendLayout = <span class="keyword">new</span> QGridLayout();
00672     <span class="comment">// TESTING(khz): set the margin of all of the layouts to Zero</span>
00673 <span class="preprocessor">#if defined SET_ALL_MARGINS_TO_ZERO</span>
00674 <span class="preprocessor"></span>    dataAndLegendLayout-&gt;setMargin(0);
00675 <span class="preprocessor">#endif</span>
00676 <span class="preprocessor"></span>    dataAndLegendLayout-&gt;setObjectName( QString::fromLatin1( <span class="stringliteral">"dataAndLegendLayout"</span> ) );
00677     vLayout-&gt;addLayout( dataAndLegendLayout, 1000 );
00678     <span class="comment">// 4. the footer(s) area</span>
00679     footerLayout = <span class="keyword">new</span> QGridLayout();
00680     <span class="comment">// TESTING(khz): set the margin of all of the layouts to Zero</span>
00681 <span class="preprocessor">#if defined SET_ALL_MARGINS_TO_ZERO</span>
00682 <span class="preprocessor"></span>    footerLayout-&gt;setMargin(0);
00683 <span class="preprocessor">#endif</span>
00684 <span class="preprocessor"></span>    footerLayout-&gt;setObjectName( QString::fromLatin1( <span class="stringliteral">"footerLayout"</span> ) );
00685     vLayout-&gt;addLayout( footerLayout );
00686     <span class="comment">// 5. the gap below the bottom edge of the headers area</span>
00687     vLayout-&gt;addSpacing( globalLeadingBottom );
00688 
00689     <span class="comment">// the data+axes area</span>
00690     dataAndLegendLayout-&gt;addLayout( planesLayout, 1, 1 );
00691     dataAndLegendLayout-&gt;setRowStretch(    1, 1 );
00692     dataAndLegendLayout-&gt;setColumnStretch( 1, 1 );
00693 
00694     <span class="comment">//qDebug() &lt;&lt; "w-&gt;rect()" &lt;&lt; w-&gt;rect();</span>
00695 }
00696 
00697 <span class="keywordtype">void</span> Chart::Private::slotRelayout()
00698 {
00699     <span class="comment">//qDebug() &lt;&lt; "Chart relayouting started.";</span>
00700     createLayouts( chart );
00701 
00702     layoutHeadersAndFooters();
00703     layoutLegends();
00704 
00705     <span class="comment">// This triggers the qlayout, see QBoxLayout::setGeometry</span>
00706     <span class="comment">// The geometry is not necessarily w-&gt;rect(), when using paint(), this is why</span>
00707     <span class="comment">// we don't call layout-&gt;activate().</span>
00708     <span class="keyword">const</span> QRect geo( QRect( 0, 0, currentLayoutSize.width(), currentLayoutSize.height() ) );
00709     <span class="keywordflow">if</span>( geo.isValid() &amp;&amp; geo != layout-&gt;geometry() ){
00710         <span class="comment">//qDebug() &lt;&lt; "Chart slotRelayout() adjusting geometry to" &lt;&lt; geo;</span>
00711         <span class="comment">//if( coordinatePlanes.count() )</span>
00712         <span class="comment">//    qDebug() &lt;&lt; "           plane geo before" &lt;&lt; coordinatePlanes.first()-&gt;geometry();</span>
00713         layout-&gt;setGeometry( geo );
00714         <span class="comment">//if( coordinatePlanes.count() ) {</span>
00715         <span class="comment">//    qDebug() &lt;&lt; "           plane geo after " &lt;&lt; coordinatePlanes.first()-&gt;geometry();</span>
00716         <span class="comment">//}</span>
00717     }
00718 
00719     <span class="comment">// Adapt diagram drawing to the new size</span>
00720     KDAB_FOREACH (<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* plane, coordinatePlanes ) {
00721         plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_abstract_coordinate_planea16">layoutDiagrams</a>();
00722     }
00723     <span class="comment">//qDebug() &lt;&lt; "Chart relayouting done.";</span>
00724 }
00725 
00726 <span class="comment">// Called when the size of the chart changes.</span>
00727 <span class="comment">// So in theory, we only need to adjust geometries.</span>
00728 <span class="comment">// But this also needs to make sure that everything is in place for the first painting.</span>
00729 <span class="keywordtype">void</span> Chart::Private::resizeLayout( <span class="keyword">const</span> QSize&amp; size )
00730 {
00731     currentLayoutSize = size;
00732     <span class="comment">//qDebug() &lt;&lt; "Chart::resizeLayout(" &lt;&lt; currentLayoutSize &lt;&lt; ")";</span>
00733 
00734 <span class="comment">/*</span>
00735 <span class="comment">    // We need to make sure that the legend's layouts are populated,</span>
00736 <span class="comment">    // so that setGeometry gets proper sizeHints from them and resizes them properly.</span>
00737 <span class="comment">    KDAB_FOREACH( Legend *legend, legends ) {</span>
00738 <span class="comment">        // This forceRebuild will see a wrong areaGeometry, but I don't care about geometries yet,</span>
00739 <span class="comment">        // only about the fact that legends should have their contents populated.</span>
00740 <span class="comment">        // -&gt; it would be better to dissociate "building contents" and "resizing" in Legend...</span>
00741 <span class="comment"></span>
00742 <span class="comment">//        legend-&gt;forceRebuild();</span>
00743 <span class="comment"></span>
00744 <span class="comment">        legend-&gt;resizeLayout( size );</span>
00745 <span class="comment">    }</span>
00746 <span class="comment">*/</span>
00747     slotLayoutPlanes(); <span class="comment">// includes slotRelayout</span>
00748 
00749     <span class="comment">//qDebug() &lt;&lt; "Chart::resizeLayout done";</span>
00750 }
00751 
00752 
00753 <span class="keywordtype">void</span> Chart::Private::paintAll( QPainter* painter )
00754 {
00755     QRect rect( QPoint(0, 0), currentLayoutSize );
00756 
00757     <span class="comment">//qDebug() &lt;&lt; this&lt;&lt;"::paintAll() uses layout size" &lt;&lt; currentLayoutSize;</span>
00758 
00759     <span class="comment">// Paint the background (if any)</span>
00760     <a class="code" href="class_k_d_chart_1_1_abstract_area_base.html#_k_d_chart_1_1_text_areae0">KDChart::AbstractAreaBase::paintBackgroundAttributes</a>(
00761         *painter, rect, backgroundAttributes );
00762     <span class="comment">// Paint the frame (if any)</span>
00763     <a class="code" href="class_k_d_chart_1_1_abstract_area_base.html#_k_d_chart_1_1_text_areae1">KDChart::AbstractAreaBase::paintFrameAttributes</a>(
00764         *painter, rect, frameAttributes );
00765 
00766     chart-&gt;reLayoutFloatingLegends();
00767 
00768     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_abstract_area.html">KDChart::AbstractArea</a>* layoutItem, layoutItems ) {
00769         layoutItem-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_area.html#_k_d_chart_1_1_polar_coordinate_planea29">paintAll</a>( *painter );
00770     }
00771     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html">KDChart::AbstractLayoutItem</a>* planeLayoutItem, planeLayoutItems ) {
00772                 planeLayoutItem-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html#_k_d_chart_1_1_vertical_line_layout_itema6">paintAll</a>( *painter );
00773     }
00774     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_text_area.html">KDChart::TextArea</a>* textLayoutItem, textLayoutItems ) {
00775         textLayoutItem-&gt;<a class="code" href="class_k_d_chart_1_1_text_area.html#_k_d_chart_1_1_text_areaa14">paintAll</a>( *painter );
00776     }
00777 }
00778 
00779 <span class="comment">// ******** Chart interface implementation ***********</span>
00780 
<a name="l00781"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta4">00781</a> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta4">Chart::Chart</a> ( <a class="code" href="class_q_widget.html">QWidget</a>* parent )
00782     : <a class="code" href="class_q_widget.html">QWidget</a> ( parent )
00783     , _d( new Private( this ) )
00784 {
00785 <span class="preprocessor">#if defined KDAB_EVAL</span>
00786 <span class="preprocessor"></span>    EvalDialog::checkEvalLicense( <span class="stringliteral">"KD Chart"</span> );
00787 <span class="preprocessor">#endif</span>
00788 <span class="preprocessor"></span>
00789     <a class="code" href="class_k_d_chart_1_1_frame_attributes.html">FrameAttributes</a> frameAttrs;
00790     frameAttrs.<a class="code" href="class_k_d_chart_1_1_frame_attributes.html#_k_d_chart_1_1_frame_attributesa10">setVisible</a>( <span class="keyword">true</span> );
00791     frameAttrs.<a class="code" href="class_k_d_chart_1_1_frame_attributes.html#_k_d_chart_1_1_frame_attributesa9">setPen</a>( QPen( Qt::black ) );
00792     frameAttrs.<a class="code" href="class_k_d_chart_1_1_frame_attributes.html#_k_d_chart_1_1_frame_attributesa8">setPadding</a>( 1 );
00793     <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta24">setFrameAttributes</a>( frameAttrs );
00794 
00795     <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta0">addCoordinatePlane</a>( <span class="keyword">new</span> <a class="code" href="class_k_d_chart_1_1_cartesian_coordinate_plane.html">CartesianCoordinatePlane</a> ( <span class="keyword">this</span> ) );
00796 }
00797 
<a name="l00798"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta33">00798</a> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta33">Chart::~Chart</a>()
00799 {
00800     <span class="keyword">delete</span> _d;
00801 }
00802 
<a name="l00803"></a><a class="code" href="_k_d_chart_chart_8cpp.html#a3">00803</a> <span class="preprocessor">#define d d_func()</span>
00804 <span class="preprocessor"></span>
<a name="l00805"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta24">00805</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta24">Chart::setFrameAttributes</a>( <span class="keyword">const</span> <a class="code" href="class_k_d_chart_1_1_frame_attributes.html">FrameAttributes</a> &amp;a )
00806 {
00807     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;frameAttributes = a;
00808 }
00809 
<a name="l00810"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta8">00810</a> <a class="code" href="class_k_d_chart_1_1_frame_attributes.html">FrameAttributes</a> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta8">Chart::frameAttributes</a>()<span class="keyword"> const</span>
00811 <span class="keyword"></span>{
00812     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;frameAttributes;
00813 }
00814 
<a name="l00815"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta22">00815</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta22">Chart::setBackgroundAttributes</a>( <span class="keyword">const</span> <a class="code" href="class_k_d_chart_1_1_background_attributes.html">BackgroundAttributes</a> &amp;a )
00816 {
00817     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;backgroundAttributes = a;
00818 }
00819 
<a name="l00820"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta3">00820</a> <a class="code" href="class_k_d_chart_1_1_background_attributes.html">BackgroundAttributes</a> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta3">Chart::backgroundAttributes</a>()<span class="keyword"> const</span>
00821 <span class="keyword"></span>{
00822     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;backgroundAttributes;
00823 }
00824 
<a name="l00825"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta6">00825</a> QLayout* <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta6">Chart::coordinatePlaneLayout</a>()
00826 {
00827     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;planesLayout;
00828 }
00829 
<a name="l00830"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta5">00830</a> <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta5">Chart::coordinatePlane</a>()
00831 {
00832     <span class="keywordflow">if</span> ( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes.isEmpty() )
00833     {
00834         qWarning() &lt;&lt; <span class="stringliteral">"Chart::coordinatePlane: warning: no coordinate plane defined."</span>;
00835         <span class="keywordflow">return</span> 0;
00836     } <span class="keywordflow">else</span> {
00837         <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes.first();
00838     }
00839 }
00840 
<a name="l00841"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta7">00841</a> <a class="code" href="namespace_k_d_chart.html#a4">CoordinatePlaneList</a> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta7">Chart::coordinatePlanes</a>()
00842 {
00843     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes;
00844 }
00845 
<a name="l00846"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta0">00846</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta0">Chart::addCoordinatePlane</a>( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* plane )
00847 {
00848     connect( plane, SIGNAL( destroyedCoordinatePlane( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* ) ),
00849              <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>,   SLOT( slotUnregisterDestroyedPlane( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* ) ) );
00850     connect( plane, SIGNAL( needUpdate() ),       <span class="keyword">this</span>,   SLOT( update() ) );
00851     connect( plane, SIGNAL( needRelayout() ),     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>,      SLOT( slotRelayout() ) ) ;
00852     connect( plane, SIGNAL( needLayoutPlanes() ), <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>,      SLOT( slotLayoutPlanes() ) ) ;
00853     connect( plane, SIGNAL( propertiesChanged() ),<span class="keyword">this</span>, SIGNAL( propertiesChanged() ) );
00854     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes.append( plane );
00855     plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea52">setParent</a>( <span class="keyword">this</span> );
00856     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotLayoutPlanes();
00857 }
00858 
<a name="l00859"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta19">00859</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta19">Chart::replaceCoordinatePlane</a>( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* plane,
00860                                     <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* oldPlane_ )
00861 {
00862     <span class="keywordflow">if</span>( plane &amp;&amp; oldPlane_ != plane ){
00863         <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* oldPlane = oldPlane_;
00864         <span class="keywordflow">if</span>( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes.count() ){
00865             <span class="keywordflow">if</span>( ! oldPlane )
00866                 oldPlane = <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes.first();
00867             <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta30">takeCoordinatePlane</a>( oldPlane );
00868         }
00869         <span class="keyword">delete</span> oldPlane;
00870         <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta0">addCoordinatePlane</a>( plane );
00871     }
00872 }
00873 
<a name="l00874"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta30">00874</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta30">Chart::takeCoordinatePlane</a>( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* plane )
00875 {
00876     <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes.indexOf( plane );
00877     <span class="keywordflow">if</span>( idx != -1 ){
00878         <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes.takeAt( idx );
00879         disconnect( plane, SIGNAL( destroyedCoordinatePlane( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* ) ),
00880                     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>, SLOT( slotUnregisterDestroyedPlane( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* ) ) );
00881         plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_layout_item.html#_k_d_chart_1_1_vertical_line_layout_itema9">removeFromParentLayout</a>();
00882         plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea52">setParent</a>( 0 );
00883     }
00884     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotLayoutPlanes();
00885 }
00886 
<a name="l00887"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta25">00887</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta25">Chart::setGlobalLeading</a>( <span class="keywordtype">int</span> left, <span class="keywordtype">int</span> top, <span class="keywordtype">int</span> right, <span class="keywordtype">int</span> bottom )
00888 {
00889     <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta27">setGlobalLeadingLeft</a>( left );
00890     <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta29">setGlobalLeadingTop</a>( top );
00891     <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta28">setGlobalLeadingRight</a>( right );
00892     <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta26">setGlobalLeadingBottom</a>( bottom );
00893     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotRelayout();
00894 }
00895 
<a name="l00896"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta27">00896</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta27">Chart::setGlobalLeadingLeft</a>( <span class="keywordtype">int</span> leading )
00897 {
00898     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;globalLeadingLeft = leading;
00899     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotRelayout();
00900 }
00901 
<a name="l00902"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta10">00902</a> <span class="keywordtype">int</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta10">Chart::globalLeadingLeft</a>()<span class="keyword"> const</span>
00903 <span class="keyword"></span>{
00904     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;globalLeadingLeft;
00905 }
00906 
<a name="l00907"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta29">00907</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta29">Chart::setGlobalLeadingTop</a>( <span class="keywordtype">int</span> leading )
00908 {
00909     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;globalLeadingTop = leading;
00910     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotRelayout();
00911 }
00912 
<a name="l00913"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta12">00913</a> <span class="keywordtype">int</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta12">Chart::globalLeadingTop</a>()<span class="keyword"> const</span>
00914 <span class="keyword"></span>{
00915     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;globalLeadingTop;
00916 }
00917 
<a name="l00918"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta28">00918</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta28">Chart::setGlobalLeadingRight</a>( <span class="keywordtype">int</span> leading )
00919 {
00920     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;globalLeadingRight = leading;
00921     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotRelayout();
00922 }
00923 
<a name="l00924"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta11">00924</a> <span class="keywordtype">int</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta11">Chart::globalLeadingRight</a>()<span class="keyword"> const</span>
00925 <span class="keyword"></span>{
00926     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;globalLeadingRight;
00927 }
00928 
<a name="l00929"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta26">00929</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta26">Chart::setGlobalLeadingBottom</a>( <span class="keywordtype">int</span> leading )
00930 {
00931     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;globalLeadingBottom = leading;
00932     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotRelayout();
00933 }
00934 
<a name="l00935"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta9">00935</a> <span class="keywordtype">int</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta9">Chart::globalLeadingBottom</a>()<span class="keyword"> const</span>
00936 <span class="keyword"></span>{
00937     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;globalLeadingBottom;
00938 }
00939 
<a name="l00940"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta17">00940</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta17">Chart::paint</a>( QPainter* painter, <span class="keyword">const</span> QRect&amp; target )
00941 {
00942     <span class="keywordflow">if</span>( target.isEmpty() || !painter ) <span class="keywordflow">return</span>;
00943     <span class="comment">//qDebug() &lt;&lt; "Chart::paint( ..," &lt;&lt; target &lt;&lt; ")";</span>
00944 
00945     GlobalMeasureScaling::instance()-&gt;setFactors(
00946             static_cast&lt;qreal&gt;(target.width()) /
00947             static_cast&lt;qreal&gt;(geometry().size().width()),
00948             static_cast&lt;qreal&gt;(target.height()) /
00949             static_cast&lt;qreal&gt;(geometry().size().height()) );
00950 
00951     <span class="keywordflow">if</span>( target.size() != <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;currentLayoutSize ){
00952         <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;resizeLayout( target.size() );
00953     }
00954     <span class="keyword">const</span> QPoint translation = target.topLeft();
00955     painter-&gt;translate( translation );
00956 
00957     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;paintAll( painter );
00958 
00959     <span class="comment">// for debugging:</span>
00960     <span class="comment">//painter-&gt;setPen(QPen(Qt::blue, 8));</span>
00961     <span class="comment">//painter-&gt;drawRect(target.adjusted(12,12,-12,-12));</span>
00962 
00963     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a> *<a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta15">legend</a>, <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends ) {
00964         <span class="keyword">const</span> <span class="keywordtype">bool</span> hidden = legend-&gt;isHidden() &amp;&amp; legend-&gt;testAttribute(Qt::WA_WState_ExplicitShowHide);
00965         <span class="keywordflow">if</span> ( !hidden ) {
00966             <span class="comment">//qDebug() &lt;&lt; "painting legend at " &lt;&lt; legend-&gt;geometry();</span>
00967             legend-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_area_widget.html#_k_d_chart_1_1_legenda32">paintIntoRect</a>( *painter, legend-&gt;geometry() );
00968             <span class="comment">//testing:</span>
00969             <span class="comment">//legend-&gt;paintIntoRect( *painter, legend-&gt;geometry().adjusted(-100,0,-100,0) );</span>
00970         }
00971     }
00972 
00973     painter-&gt;translate( -translation.x(), -translation.y() );
00974 
00975     GlobalMeasureScaling::instance()-&gt;resetFactors();
00976 
00977     <span class="comment">//qDebug() &lt;&lt; "KDChart::Chart::paint() done.\n";</span>
00978 }
00979 
<a name="l00980"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_chartb2">00980</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_chartb2">Chart::resizeEvent</a> ( QResizeEvent * )
00981 {
00982     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;resizeLayout( size() );
00983     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* plane, <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes ){
00984         plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea51">setGridNeedsRecalculate</a>();
00985     }
00986     <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta18">reLayoutFloatingLegends</a>();
00987 }
00988 
00989 
<a name="l00990"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta18">00990</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta18">Chart::reLayoutFloatingLegends</a>()
00991 {
00992     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a> *<a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta15">legend</a>, <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends ) {
00993         <span class="keyword">const</span> <span class="keywordtype">bool</span> hidden = legend-&gt;isHidden() &amp;&amp; legend-&gt;testAttribute(Qt::WA_WState_ExplicitShowHide);
00994         <span class="keywordflow">if</span> ( legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda35">position</a>().<a class="code" href="class_k_d_chart_1_1_position.html#_k_d_chart_1_1_positiona2">isFloating</a>() &amp;&amp; !hidden ){
00995             <span class="comment">// resize the legend</span>
00996             <span class="keyword">const</span> QSize legendSize( legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda72">sizeHint</a>() );
00997             legend-&gt;setGeometry( QRect( legend-&gt;geometry().topLeft(), legendSize ) );
00998             <span class="comment">// find the legends corner point (reference point plus any paddings)</span>
00999             <span class="keyword">const</span> <a class="code" href="class_k_d_chart_1_1_relative_position.html">RelativePosition</a> relPos( legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda15">floatingPosition</a>() );
01000             QPointF pt( relPos.<a class="code" href="class_k_d_chart_1_1_relative_position.html#_k_d_chart_1_1_relative_positiona1">calculatedPoint</a>( size() ) );
01001             qDebug() &lt;&lt; pt;
01002             <span class="comment">// calculate the legend's top left point</span>
01003             <span class="keyword">const</span> Qt::Alignment alignTopLeft = Qt::AlignBottom | Qt::AlignLeft;
01004             <span class="keywordflow">if</span>( (relPos.<a class="code" href="class_k_d_chart_1_1_relative_position.html#_k_d_chart_1_1_relative_positiona0">alignment</a>() &amp; alignTopLeft) != alignTopLeft ){
01005                 <span class="keywordflow">if</span>( relPos.<a class="code" href="class_k_d_chart_1_1_relative_position.html#_k_d_chart_1_1_relative_positiona0">alignment</a>() &amp; Qt::AlignRight )
01006                     pt.rx() -= legendSize.width();
01007                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( relPos.<a class="code" href="class_k_d_chart_1_1_relative_position.html#_k_d_chart_1_1_relative_positiona0">alignment</a>() &amp; Qt::AlignHCenter )
01008                     pt.rx() -= 0.5 * legendSize.width();
01009 
01010                 <span class="keywordflow">if</span>( relPos.<a class="code" href="class_k_d_chart_1_1_relative_position.html#_k_d_chart_1_1_relative_positiona0">alignment</a>() &amp; Qt::AlignBottom )
01011                     pt.ry() -= legendSize.height();
01012                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( relPos.<a class="code" href="class_k_d_chart_1_1_relative_position.html#_k_d_chart_1_1_relative_positiona0">alignment</a>() &amp; Qt::AlignVCenter )
01013                     pt.ry() -= 0.5 * legendSize.height();
01014             }
01015             qDebug() &lt;&lt; pt &lt;&lt; endl;
01016             legend-&gt;move( static_cast&lt;int&gt;(pt.x()), static_cast&lt;int&gt;(pt.y()) );
01017         }
01018     }
01019 }
01020 
01021 
<a name="l01022"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_chartb1">01022</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_chartb1">Chart::paintEvent</a>( QPaintEvent* )
01023 {
01024     QPainter painter( <span class="keyword">this</span> );
01025 
01026     <span class="keywordflow">if</span>( size() != <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;currentLayoutSize ){
01027         <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;resizeLayout( size() );
01028         <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta18">reLayoutFloatingLegends</a>();
01029     }
01030 
01031     <span class="comment">//FIXME(khz): Paint the background/frame too!</span>
01032     <span class="comment">//            (can we derive Chart from AreaWidget ??)</span>
01033     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;paintAll( &amp;painter );
01034 }
01035 
<a name="l01036"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta1">01036</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta1">Chart::addHeaderFooter</a>( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* headerFooter )
01037 {
01038     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;headerFooters.append( headerFooter );
01039     headerFooter-&gt;<a class="code" href="class_k_d_chart_1_1_header_footer.html#_k_d_chart_1_1_header_footera32">setParent</a>( <span class="keyword">this</span> );
01040     connect( headerFooter, SIGNAL( destroyedHeaderFooter( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* ) ),
01041              <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>, SLOT( slotUnregisterDestroyedHeaderFooter( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* ) ) );
01042     connect( headerFooter, SIGNAL( positionChanged( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* ) ),
01043              <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>, SLOT( slotRelayout() ) );
01044     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotRelayout();
01045 }
01046 
<a name="l01047"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta20">01047</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta20">Chart::replaceHeaderFooter</a>( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* headerFooter,
01048                                  <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* oldHeaderFooter_ )
01049 {
01050     <span class="keywordflow">if</span>( headerFooter &amp;&amp; oldHeaderFooter_ != headerFooter ){
01051         <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* oldHeaderFooter = oldHeaderFooter_;
01052         <span class="keywordflow">if</span>( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;headerFooters.count() ){
01053             <span class="keywordflow">if</span>( ! oldHeaderFooter )
01054                 oldHeaderFooter =  <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;headerFooters.first();
01055             <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta31">takeHeaderFooter</a>( oldHeaderFooter );
01056         }
01057         <span class="keyword">delete</span> oldHeaderFooter;
01058         <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta1">addHeaderFooter</a>( headerFooter );
01059     }
01060 }
01061 
<a name="l01062"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta31">01062</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta31">Chart::takeHeaderFooter</a>( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* headerFooter )
01063 {
01064     <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;headerFooters.indexOf( headerFooter );
01065     <span class="keywordflow">if</span>( idx != -1 ){
01066         <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;headerFooters.takeAt( idx );
01067         disconnect( headerFooter, SIGNAL( destroyedHeaderFooter( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* ) ),
01068                     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>, SLOT( slotUnregisterDestroyedHeaderFooter( <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* ) ) );
01069         headerFooter-&gt;<a class="code" href="class_k_d_chart_1_1_header_footer.html#_k_d_chart_1_1_header_footera32">setParent</a>( 0 );
01070     }
01071     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotRelayout();
01072 }
01073 
<a name="l01074"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta13">01074</a> <a class="code" href="class_k_d_chart_1_1_header_footer.html">HeaderFooter</a>* <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta13">Chart::headerFooter</a>()
01075 {
01076     <span class="keywordflow">if</span>( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;headerFooters.isEmpty() ) {
01077         <span class="keywordflow">return</span> 0;
01078     } <span class="keywordflow">else</span> {
01079         <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;headerFooters.first();
01080     }
01081 }
01082 
<a name="l01083"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta14">01083</a> <a class="code" href="namespace_k_d_chart.html#a5">HeaderFooterList</a> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta14">Chart::headerFooters</a>()
01084 {
01085     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;headerFooters;
01086 }
01087 
01088 
<a name="l01089"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta2">01089</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta2">Chart::addLegend</a>( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* legend )
01090 {
01091     <span class="keywordflow">if</span>( ! legend ) <span class="keywordflow">return</span>;
01092 
01093     <span class="comment">//qDebug() &lt;&lt; "adding the legend";</span>
01094     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends.append( legend );
01095     legend-&gt;setParent( <span class="keyword">this</span> );
01096 
01097     <a class="code" href="class_k_d_chart_1_1_text_attributes.html">TextAttributes</a> textAttrs( legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda75">textAttributes</a>() );
01098 
01099     <a class="code" href="class_k_d_chart_1_1_measure.html">KDChart::Measure</a> measure( textAttrs.<a class="code" href="class_k_d_chart_1_1_text_attributes.html#_k_d_chart_1_1_text_attributesa5">fontSize</a>() );
01100     measure.<a class="code" href="class_k_d_chart_1_1_measure.html#_k_d_chart_1_1_measurea15">setRelativeMode</a>( <span class="keyword">this</span>, KDChartEnums::MeasureOrientationMinimum );
01101     measure.<a class="code" href="class_k_d_chart_1_1_measure.html#_k_d_chart_1_1_measurea16">setValue</a>( 20 );
01102     textAttrs.<a class="code" href="class_k_d_chart_1_1_text_attributes.html#_k_d_chart_1_1_text_attributesa17">setFontSize</a>( measure );
01103     legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda66">setTextAttributes</a>( textAttrs );
01104 
01105     textAttrs = legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda78">titleTextAttributes</a>();
01106     measure.<a class="code" href="class_k_d_chart_1_1_measure.html#_k_d_chart_1_1_measurea15">setRelativeMode</a>( <span class="keyword">this</span>, KDChartEnums::MeasureOrientationMinimum );
01107     measure.<a class="code" href="class_k_d_chart_1_1_measure.html#_k_d_chart_1_1_measurea16">setValue</a>( 24 );
01108     textAttrs.<a class="code" href="class_k_d_chart_1_1_text_attributes.html#_k_d_chart_1_1_text_attributesa17">setFontSize</a>( measure );
01109 
01110     legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda68">setTitleTextAttributes</a>( textAttrs );
01111 
01112     legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda61">setReferenceArea</a>( <span class="keyword">this</span> );
01113 
01114 <span class="comment">/*</span>
01115 <span class="comment">    future: Use relative sizes for the markers too!</span>
01116 <span class="comment"></span>
01117 <span class="comment">    const uint nMA = Legend::datasetCount();</span>
01118 <span class="comment">    for( uint iMA = 0; iMA &lt; nMA; ++iMA ){</span>
01119 <span class="comment">        MarkerAttributes ma( legend-&gt;markerAttributes( iMA ) );</span>
01120 <span class="comment">        ma.setMarkerSize( ... )</span>
01121 <span class="comment">        legend-&gt;setMarkerAttributes( iMA, ma )</span>
01122 <span class="comment">    }</span>
01123 <span class="comment">*/</span>
01124 
01125     connect( legend, SIGNAL( destroyedLegend( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* ) ),
01126              <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>, SLOT( slotUnregisterDestroyedLegend( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* ) ) );
01127     connect( legend, SIGNAL( positionChanged( <a class="code" href="class_k_d_chart_1_1_abstract_area_widget.html">AbstractAreaWidget</a>* ) ),
01128              <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>, SLOT( slotLayoutPlanes() ) ); <span class="comment">//slotRelayout() ) );</span>
01129     connect( legend, SIGNAL( propertiesChanged() ),<span class="keyword">this</span>, SIGNAL( propertiesChanged() ) );
01130     legend-&gt;<a class="code" href="class_k_d_chart_1_1_legend.html#_k_d_chart_1_1_legenda70">setVisible</a>( <span class="keyword">true</span> );
01131     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotRelayout();
01132 }
01133 
01134 
<a name="l01135"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta21">01135</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta21">Chart::replaceLegend</a>( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* legend, <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* oldLegend_ )
01136 {
01137     <span class="keywordflow">if</span>( legend &amp;&amp; oldLegend_ != legend ){
01138         <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* oldLegend = oldLegend_;
01139         <span class="keywordflow">if</span>( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends.count() ){
01140             <span class="keywordflow">if</span>( ! oldLegend )
01141                 oldLegend = <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends.first();
01142             <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta32">takeLegend</a>( oldLegend );
01143         }
01144         <span class="keyword">delete</span> oldLegend;
01145         <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta2">addLegend</a>( legend );
01146     }
01147 }
01148 
<a name="l01149"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta32">01149</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta32">Chart::takeLegend</a>( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* legend )
01150 {
01151     <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends.indexOf( legend );
01152     <span class="keywordflow">if</span>( idx != -1 ){
01153         <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends.takeAt( idx );
01154         disconnect( legend, SIGNAL( destroyedLegend( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* ) ),
01155                     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>, SLOT( slotUnregisterDestroyedLegend( <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* ) ) );
01156         legend-&gt;setParent( 0 );
01157     }
01158     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;slotRelayout();
01159 }
01160 
<a name="l01161"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta15">01161</a> <a class="code" href="class_k_d_chart_1_1_legend.html">Legend</a>* <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta15">Chart::legend</a>()
01162 {
01163     <span class="keywordflow">if</span> ( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends.isEmpty() )
01164     {
01165         <span class="keywordflow">return</span> 0;
01166     } <span class="keywordflow">else</span> {
01167         <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends.first();
01168     }
01169 }
01170 
<a name="l01171"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta16">01171</a> <a class="code" href="namespace_k_d_chart.html#a6">LegendList</a> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_charta16">Chart::legends</a>()
01172 {
01173     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;legends;
01174 }
01175 
01176 
<a name="l01177"></a><a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_chartb0">01177</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_chart.html#_k_d_chart_1_1_chartb0">Chart::mousePressEvent</a>( QMouseEvent* event )
01178 {
01179     KDAB_FOREACH( <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* plane, <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;coordinatePlanes ) {
01180        <span class="keywordflow">if</span> ( plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea11">geometry</a>().contains( event-&gt;pos() ) ) {
01181            <span class="keywordflow">if</span> ( plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea8">diagrams</a>().size() &gt; 0 ) {
01182                QPoint pos = plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea6">diagram</a>()-&gt;mapFromGlobal( event-&gt;globalPos() );
01183                QMouseEvent ev( QEvent::MouseButtonPress, pos, event-&gt;globalPos(),
01184                                event-&gt;button(), event-&gt;buttons(),
01185                                event-&gt;modifiers() );
01186                plane-&gt;<a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html#_k_d_chart_1_1_polar_coordinate_planea24">mousePressEvent</a>( &amp;ev );
01187            }
01188        }
01189     }
01190 }
01191 
01192 
01193 
01194 
01195 <span class="comment">/*</span>
01196 <span class="comment">// Unused code trying to use a push-model: This did not work</span>
01197 <span class="comment">// since we can not re-layout the planes each time when</span>
01198 <span class="comment">// Qt layouting is calling sizeHint()</span>
01199 <span class="comment">void Chart::Private::slotAdjustLeftRightColumnsForOverlappingLabels(</span>
01200 <span class="comment">        CartesianAxis* axis, int leftOverlap, int rightOverlap)</span>
01201 <span class="comment">{</span>
01202 <span class="comment">    const QLayout* axisLayout = axis ? axis-&gt;parentLayout() : 0;</span>
01203 <span class="comment"></span>
01204 <span class="comment">    if( (! leftOverlap &amp;&amp; ! rightOverlap) || ! axis || ! axisLayout-&gt;parent() )</span>
01205 <span class="comment">        return;</span>
01206 <span class="comment"></span>
01207 <span class="comment">    bool needUpdate = false;</span>
01208 <span class="comment">    // access the planeLayout:</span>
01209 <span class="comment">    QGridLayout* grid = qobject_cast&lt;QGridLayout*&gt;(axisLayout-&gt;parent());</span>
01210 <span class="comment">    if( grid ){</span>
01211 <span class="comment">        // find the index of the parent layout in the planeLayout:</span>
01212 <span class="comment">        int idx = -1;</span>
01213 <span class="comment">        for (int i = 0; i &lt; grid-&gt;count(); ++i)</span>
01214 <span class="comment">            if( grid-&gt;itemAt(i) == axisLayout )</span>
01215 <span class="comment">                idx = i;</span>
01216 <span class="comment">        // set the min widths of the neighboring column:</span>
01217 <span class="comment">        if( idx &gt; -1 ){</span>
01218 <span class="comment">            int row, column, rowSpan, columnSpan;</span>
01219 <span class="comment">            grid-&gt;getItemPosition( idx, &amp;row, &amp;column, &amp;rowSpan, &amp;columnSpan );</span>
01220 <span class="comment">            const int leftColumn = column-1;</span>
01221 <span class="comment">            const int rightColumn = column+columnSpan;</span>
01222 <span class="comment">            // find the left/right axes layouts</span>
01223 <span class="comment">            QHBoxLayout* leftAxesLayout=0;</span>
01224 <span class="comment">            QHBoxLayout* rightAxesLayout=0;</span>
01225 <span class="comment">            for( int i = 0;</span>
01226 <span class="comment">                 (!leftAxesLayout || !rightAxesLayout) &amp;&amp; i &lt; grid-&gt;count();</span>
01227 <span class="comment">                 ++i )</span>
01228 <span class="comment">            {</span>
01229 <span class="comment">                int r, c, rs, cs;</span>
01230 <span class="comment">                grid-&gt;getItemPosition( i, &amp;r, &amp;c, &amp;rs, &amp;cs );</span>
01231 <span class="comment">                if( c+cs-1 == leftColumn )</span>
01232 <span class="comment">                    leftAxesLayout = dynamic_cast&lt;QHBoxLayout*&gt;(grid-&gt;itemAt(i));</span>
01233 <span class="comment">                if( c == rightColumn )</span>
01234 <span class="comment">                    rightAxesLayout = dynamic_cast&lt;QHBoxLayout*&gt;(grid-&gt;itemAt(i));</span>
01235 <span class="comment">            }</span>
01236 <span class="comment">            if( leftAxesLayout ){</span>
01237 <span class="comment">                const int leftColumnMinWidth = leftOverlap;</span>
01238 <span class="comment">                QLayoutItem* item = leftAxesLayout-&gt;count()</span>
01239 <span class="comment">                        ? dynamic_cast&lt;QLayoutItem*&gt;(leftAxesLayout-&gt;itemAt(leftAxesLayout-&gt;count()-1))</span>
01240 <span class="comment">                    : 0;</span>
01241 <span class="comment">                QSpacerItem* spacer = dynamic_cast&lt;QSpacerItem*&gt;(item);</span>
01242 <span class="comment">                if( spacer ){</span>
01243 <span class="comment">                    if( spacer-&gt;sizeHint().width() &lt; leftColumnMinWidth ){</span>
01244 <span class="comment">                        needUpdate = true;</span>
01245 <span class="comment">                        spacer-&gt;changeSize(leftColumnMinWidth, 1);</span>
01246 <span class="comment">                        qDebug() &lt;&lt; "adjusted left spacer-&gt;sizeHint().width() to" &lt;&lt; spacer-&gt;sizeHint().width();</span>
01247 <span class="comment">                    }</span>
01248 <span class="comment">                }else{</span>
01249 <span class="comment">                    AbstractAxis* axis = dynamic_cast&lt;AbstractAxis*&gt;(item);</span>
01250 <span class="comment">                    if( !axis || axis-&gt;sizeHint().width() &lt; leftColumnMinWidth ){</span>
01251 <span class="comment">                        needUpdate = true;</span>
01252 <span class="comment">                        leftAxesLayout-&gt;insertSpacing( -1, leftColumnMinWidth );</span>
01253 <span class="comment">                        qDebug() &lt;&lt; "adjusted column" &lt;&lt; leftColumn &lt;&lt; "min width to" &lt;&lt; leftColumnMinWidth;</span>
01254 <span class="comment">                    }</span>
01255 <span class="comment">                }</span>
01256 <span class="comment">            }</span>
01257 <span class="comment">            if( rightAxesLayout ){</span>
01258 <span class="comment">                const int rightColumnMinWidth = rightOverlap;</span>
01259 <span class="comment">                QLayoutItem* item = rightAxesLayout-&gt;count()</span>
01260 <span class="comment">                        ? dynamic_cast&lt;QLayoutItem*&gt;(rightAxesLayout-&gt;itemAt(0))</span>
01261 <span class="comment">                    : 0;</span>
01262 <span class="comment">                QSpacerItem* spacer = dynamic_cast&lt;QSpacerItem*&gt;(item);</span>
01263 <span class="comment">                if( spacer ){</span>
01264 <span class="comment">                    if( spacer-&gt;sizeHint().width() &lt; rightColumnMinWidth ){</span>
01265 <span class="comment">                        needUpdate = true;</span>
01266 <span class="comment">                        spacer-&gt;changeSize(rightColumnMinWidth, 1);</span>
01267 <span class="comment">                        qDebug() &lt;&lt; "adjusted right spacer-&gt;sizeHint().width() to" &lt;&lt; spacer-&gt;sizeHint().width();</span>
01268 <span class="comment">                    }</span>
01269 <span class="comment">                }else{</span>
01270 <span class="comment">                    AbstractAxis* axis = dynamic_cast&lt;AbstractAxis*&gt;(item);</span>
01271 <span class="comment">                    if( !axis || axis-&gt;sizeHint().width() &lt; rightColumnMinWidth ){</span>
01272 <span class="comment">                        needUpdate = true;</span>
01273 <span class="comment">                        rightAxesLayout-&gt;insertSpacing( 0, rightColumnMinWidth );</span>
01274 <span class="comment">                        qDebug() &lt;&lt; "adjusted column" &lt;&lt; rightColumn &lt;&lt; "min width to" &lt;&lt; rightColumnMinWidth;</span>
01275 <span class="comment">                    }</span>
01276 <span class="comment">                }</span>
01277 <span class="comment">            }</span>
01278 <span class="comment">        }</span>
01279 <span class="comment">    }</span>
01280 <span class="comment">    if( needUpdate ){</span>
01281 <span class="comment">        ;// do something ...?</span>
01282 <span class="comment">    }</span>
01283 <span class="comment">}</span>
01284 <span class="comment"></span>
01285 <span class="comment"></span>
01286 <span class="comment">void Chart::Private::slotAdjustTopBottomRowsForOverlappingLabels(</span>
01287 <span class="comment">        CartesianAxis* axis, int topOverlap, int bottomOverlap)</span>
01288 <span class="comment">{</span>
01289 <span class="comment">    const QLayout* axisLayout = axis ? axis-&gt;parentLayout() : 0;</span>
01290 <span class="comment"></span>
01291 <span class="comment">    if( (! topOverlap &amp;&amp; ! bottomOverlap) || ! axisLayout || ! axisLayout-&gt;parent() )</span>
01292 <span class="comment">        return;</span>
01293 <span class="comment"></span>
01294 <span class="comment">    // access the planeLayout:</span>
01295 <span class="comment">    QGridLayout* grid = qobject_cast&lt;QGridLayout*&gt;(axisLayout-&gt;parent());</span>
01296 <span class="comment">    if( grid ){</span>
01297 <span class="comment">            // find the index of the parent layout in the planeLayout:</span>
01298 <span class="comment">        int idx = -1;</span>
01299 <span class="comment">        for (int i = 0; i &lt; grid-&gt;count(); ++i)</span>
01300 <span class="comment">            if( grid-&gt;itemAt(i) == axisLayout )</span>
01301 <span class="comment">                idx = i;</span>
01302 <span class="comment">            // set the min widths of the neighboring column:</span>
01303 <span class="comment">        if( idx &gt; -1 ){</span>
01304 <span class="comment">            int row, column, rowSpan, columnSpan;</span>
01305 <span class="comment">            grid-&gt;getItemPosition( idx, &amp;row, &amp;column, &amp;rowSpan, &amp;columnSpan );</span>
01306 <span class="comment">            const int topRow = row-1;</span>
01307 <span class="comment">            const int bottomRow = row+rowSpan;</span>
01308 <span class="comment">                // find the left/right axes layouts</span>
01309 <span class="comment">            QVBoxLayout* topAxesLayout=0;</span>
01310 <span class="comment">            QVBoxLayout* bottomAxesLayout=0;</span>
01311 <span class="comment">            for( int i = 0;</span>
01312 <span class="comment">                 (!topAxesLayout || !bottomAxesLayout) &amp;&amp; i &lt; grid-&gt;count();</span>
01313 <span class="comment">                 ++i )</span>
01314 <span class="comment">            {</span>
01315 <span class="comment">                int r, c, rs, cs;</span>
01316 <span class="comment">                grid-&gt;getItemPosition( i, &amp;r, &amp;c, &amp;rs, &amp;cs );</span>
01317 <span class="comment">                if( r+rs-1 == topRow )</span>
01318 <span class="comment">                    topAxesLayout = dynamic_cast&lt;QVBoxLayout*&gt;(grid-&gt;itemAt(i));</span>
01319 <span class="comment">                if( r == bottomRow )</span>
01320 <span class="comment">                    bottomAxesLayout = dynamic_cast&lt;QVBoxLayout*&gt;(grid-&gt;itemAt(i));</span>
01321 <span class="comment">            }</span>
01322 <span class="comment">            if( topAxesLayout ){</span>
01323 <span class="comment">                const int topRowMinWidth = topOverlap;</span>
01324 <span class="comment">                QLayoutItem* item = topAxesLayout-&gt;count()</span>
01325 <span class="comment">                        ? dynamic_cast&lt;QLayoutItem*&gt;(topAxesLayout-&gt;itemAt(topAxesLayout-&gt;count()-1))</span>
01326 <span class="comment">                    : 0;</span>
01327 <span class="comment">                QSpacerItem* spacer = dynamic_cast&lt;QSpacerItem*&gt;(item);</span>
01328 <span class="comment">                if( spacer ){</span>
01329 <span class="comment">                    if( spacer-&gt;sizeHint().height() &lt; topRowMinWidth ){</span>
01330 <span class="comment">                        spacer-&gt;changeSize(1, topRowMinWidth);</span>
01331 <span class="comment">                        qDebug() &lt;&lt; "adjusted top spacer-&gt;sizeHint().height() to" &lt;&lt; spacer-&gt;sizeHint().height();</span>
01332 <span class="comment">                    }</span>
01333 <span class="comment">                }else{</span>
01334 <span class="comment">                    AbstractAxis* axis = dynamic_cast&lt;AbstractAxis*&gt;(item);</span>
01335 <span class="comment">                    if( !axis || axis-&gt;sizeHint().height() &lt; topRowMinWidth ){</span>
01336 <span class="comment">                        topAxesLayout-&gt;insertSpacing( -1, topRowMinWidth );</span>
01337 <span class="comment">                        qDebug() &lt;&lt; "adjusted row" &lt;&lt; topRow &lt;&lt; "min height to" &lt;&lt; topRowMinWidth;</span>
01338 <span class="comment">                    }</span>
01339 <span class="comment">                }</span>
01340 <span class="comment">            }</span>
01341 <span class="comment">            if( bottomAxesLayout ){</span>
01342 <span class="comment">                const int bottomRowMinWidth = bottomOverlap;</span>
01343 <span class="comment">                QLayoutItem* item = bottomAxesLayout-&gt;count()</span>
01344 <span class="comment">                        ? dynamic_cast&lt;QLayoutItem*&gt;(bottomAxesLayout-&gt;itemAt(0))</span>
01345 <span class="comment">                    : 0;</span>
01346 <span class="comment">                QSpacerItem* spacer = dynamic_cast&lt;QSpacerItem*&gt;(item);</span>
01347 <span class="comment">                if( spacer ){</span>
01348 <span class="comment">                    if( spacer-&gt;sizeHint().height() &lt; bottomRowMinWidth ){</span>
01349 <span class="comment">                        spacer-&gt;changeSize(1, bottomRowMinWidth);</span>
01350 <span class="comment">                        qDebug() &lt;&lt; "adjusted bottom spacer-&gt;sizeHint().height() to" &lt;&lt; spacer-&gt;sizeHint().height();</span>
01351 <span class="comment">                    }</span>
01352 <span class="comment">                }else{</span>
01353 <span class="comment">                    AbstractAxis* axis = dynamic_cast&lt;AbstractAxis*&gt;(item);</span>
01354 <span class="comment">                    if( !axis || axis-&gt;sizeHint().height() &lt; bottomRowMinWidth ){</span>
01355 <span class="comment">                        bottomAxesLayout-&gt;insertSpacing( 0, bottomRowMinWidth );</span>
01356 <span class="comment">                        qDebug() &lt;&lt; "adjusted row" &lt;&lt; bottomRow &lt;&lt; "min height to" &lt;&lt; bottomRowMinWidth;</span>
01357 <span class="comment">                    }</span>
01358 <span class="comment">                }</span>
01359 <span class="comment">            }</span>
01360 <span class="comment">        }</span>
01361 <span class="comment">    }</span>
01362 <span class="comment">}</span>
01363 <span class="comment">*/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu May 10 11:06:25 2007 for KD Chart 2 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > </a>1.3.6 </small></address>
</body>
</html>

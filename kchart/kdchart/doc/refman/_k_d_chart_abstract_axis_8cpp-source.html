<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>KD Chart 2: KDChartAbstractAxis.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>KDChartAbstractAxis.cpp</h1><a href="_k_d_chart_abstract_axis_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/****************************************************************************</span>
00002 <span class="comment"> ** Copyright (C) 2006 Klar√§lvdalens Datakonsult AB.  All rights reserved.</span>
00003 <span class="comment"> **</span>
00004 <span class="comment"> ** This file is part of the KD Chart library.</span>
00005 <span class="comment"> **</span>
00006 <span class="comment"> ** This file may be distributed and/or modified under the terms of the</span>
00007 <span class="comment"> ** GNU General Public License version 2 as published by the Free Software</span>
00008 <span class="comment"> ** Foundation and appearing in the file LICENSE.GPL included in the</span>
00009 <span class="comment"> ** packaging of this file.</span>
00010 <span class="comment"> **</span>
00011 <span class="comment"> ** Licensees holding valid commercial KD Chart licenses may use this file in</span>
00012 <span class="comment"> ** accordance with the KD Chart Commercial License Agreement provided with</span>
00013 <span class="comment"> ** the Software.</span>
00014 <span class="comment"> **</span>
00015 <span class="comment"> ** This file is provided AS IS with NO WARRANTY OF ANY KIND, INCLUDING THE</span>
00016 <span class="comment"> ** WARRANTY OF DESIGN, MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.</span>
00017 <span class="comment"> **</span>
00018 <span class="comment"> ** See http://www.kdab.net/kdchart for</span>
00019 <span class="comment"> **   information about KDChart Commercial License Agreements.</span>
00020 <span class="comment"> **</span>
00021 <span class="comment"> ** Contact info@kdab.net if any conditions of this</span>
00022 <span class="comment"> ** licensing are not clear to you.</span>
00023 <span class="comment"> **</span>
00024 <span class="comment"> **********************************************************************/</span>
00025 
00026 <span class="preprocessor">#include &lt;QDebug&gt;</span>
00027 
00028 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_abstract_axis_8h.html">KDChartAbstractAxis.h</a>"</span>
00029 <span class="preprocessor">#include "KDChartAbstractAxis_p.h"</span>
00030 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_abstract_diagram_8h.html">KDChartAbstractDiagram.h</a>"</span>
00031 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_abstract_cartesian_diagram_8h.html">KDChartAbstractCartesianDiagram.h</a>"</span>
00032 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_enums_8h.html">KDChartEnums.h</a>"</span>
00033 <span class="preprocessor">#include "<a class="code" href="_k_d_chart_measure_8h.html">KDChartMeasure.h</a>"</span>
00034 
00035 <span class="preprocessor">#include &lt;KDABLibFakes&gt;</span>
00036 
00037 <span class="keyword">using</span> <span class="keyword">namespace </span>KDChart;
00038 
<a name="l00039"></a><a class="code" href="_k_d_chart_abstract_axis_8cpp.html#a0">00039</a> <span class="preprocessor">#define d d_func()</span>
00040 <span class="preprocessor"></span>
00041 AbstractAxis::Private::Private( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* diagram, <a class="code" href="class_k_d_chart_1_1_abstract_axis.html">AbstractAxis</a>* axis )
00042     : observer( 0 )
00043     , mDiagram( diagram )
00044     , mAxis(    axis )
00045 {
00046     <span class="comment">// Note: We do NOT call setDiagram( diagram, axis );</span>
00047     <span class="comment">//       but it is called in AbstractAxis::delayedInit() instead!</span>
00048 }
00049 
00050 AbstractAxis::Private::~Private()
00051 {
00052     <span class="keyword">delete</span> observer;
00053     observer = 0;
00054 }
00055 
00056 <span class="keywordtype">bool</span> AbstractAxis::Private::setDiagram(
00057     <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* diagram_,
00058     <span class="keywordtype">bool</span> delayedInit )
00059 {
00060     <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* diagram = delayedInit ? mDiagram : diagram_;
00061     <span class="keywordflow">if</span>( delayedInit ){
00062         mDiagram = 0;
00063     }
00064 
00065     <span class="comment">// do not set a diagram again that was already set</span>
00066     <span class="keywordflow">if</span> (  diagram &amp;&amp;
00067         ((diagram == mDiagram) || secondaryDiagrams.contains( diagram )) )
00068         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00069 
00070     <span class="keywordtype">bool</span> bNewDiagramStored = <span class="keyword">false</span>;
00071     <span class="keywordflow">if</span> ( ! mDiagram ) {
00072         mDiagram = diagram;
00073         <span class="keyword">delete</span> observer;
00074         <span class="keywordflow">if</span> ( mDiagram ) {
00075 <span class="comment">//qDebug() &lt;&lt; "axis" &lt;&lt; (axis != 0);</span>
00076             observer = <span class="keyword">new</span> <a class="code" href="class_k_d_chart_1_1_diagram_observer.html">DiagramObserver</a>( mDiagram, mAxis );
00077             bNewDiagramStored = <span class="keyword">true</span>;
00078         }<span class="keywordflow">else</span>{
00079             observer = 0;
00080         }
00081     } <span class="keywordflow">else</span> {
00082         <span class="keywordflow">if</span> ( diagram )
00083             secondaryDiagrams.enqueue( diagram );
00084     }
00085     <span class="keywordflow">return</span> bNewDiagramStored;
00086 }
00087 
00088 <span class="keywordtype">void</span> AbstractAxis::Private::unsetDiagram( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* diagram )
00089 {
00090     <span class="keywordflow">if</span> ( diagram == mDiagram ) {
00091         mDiagram = 0;
00092         <span class="keyword">delete</span> observer;
00093         observer = 0;
00094     } <span class="keywordflow">else</span> {
00095         secondaryDiagrams.removeAll( diagram );
00096     }
00097     <span class="keywordflow">if</span>( !secondaryDiagrams.isEmpty() ) {
00098         <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a> *nextDiagram = secondaryDiagrams.dequeue();
00099         setDiagram( nextDiagram );
00100     }
00101 }
00102 
00103 <span class="keywordtype">bool</span> AbstractAxis::Private::hasDiagram( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* diagram )<span class="keyword"> const</span>
00104 <span class="keyword"></span>{
00105     <span class="keywordflow">return</span> diagram == mDiagram || secondaryDiagrams.contains( diagram );
00106 }
00107 
<a name="l00108"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_abstract_axisa0">00108</a> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_abstract_axisa0">AbstractAxis::AbstractAxis</a> ( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* diagram )
00109     : <a class="code" href="class_k_d_chart_1_1_abstract_area.html">AbstractArea</a>( new Private( diagram, this ) )
00110 {
00111     init();
00112     QTimer::singleShot(0, <span class="keyword">this</span>, SLOT(delayedInit()));
00113 }
00114 
<a name="l00115"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_abstract_axisa39">00115</a> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_abstract_axisa39">AbstractAxis::~AbstractAxis</a>()
00116 {
00117     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;mDiagram = 0;
00118     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;secondaryDiagrams.clear();
00119 }
00120 
00121 
00122 <span class="keywordtype">void</span> AbstractAxis::init()
00123 {
00124     <a class="code" href="class_k_d_chart_1_1_measure.html">Measure</a> m(
00125         12.5,
00126         KDChartEnums::MeasureCalculationModeAuto,
00127         KDChartEnums::MeasureOrientationAuto );
00128     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;textAttributes.setFontSize( m  );
00129     m.<a class="code" href="class_k_d_chart_1_1_measure.html#_k_d_chart_1_1_measurea16">setValue</a>( 5 );
00130     m.<a class="code" href="class_k_d_chart_1_1_measure.html#_k_d_chart_1_1_measurea12">setCalculationMode</a>( KDChartEnums::MeasureCalculationModeAbsolute );
00131     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;textAttributes.setMinimalFontSize( m  );
00132 }
00133 
00134 <span class="keywordtype">void</span> AbstractAxis::delayedInit()
00135 {
00136     <span class="comment">// We call setDiagram() here, because the c'tor of Private</span>
00137     <span class="comment">// only has stored the pointers, but it did not call setDiagram().</span>
00138     <span class="keywordflow">if</span>( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a> )
00139         <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;setDiagram( 0, <span class="keyword">true</span> <span class="comment">/* delayedInit */</span> );
00140 }
00141 
<a name="l00142"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa5">00142</a> <span class="keywordtype">bool</span> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa5">AbstractAxis::compare</a>( <span class="keyword">const</span> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html">AbstractAxis</a>* other )<span class="keyword">const</span>
00143 {
00144     <span class="keywordflow">if</span>( other == <span class="keyword">this</span> ) <span class="keywordflow">return</span> <span class="keyword">true</span>;
00145     <span class="keywordflow">if</span>( ! other ){
00146         <span class="comment">//qDebug() &lt;&lt; "CartesianAxis::compare() cannot compare to Null pointer";</span>
00147         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00148     }
00149     <span class="comment">/*</span>
00150 <span class="comment">    qDebug() &lt;&lt; (textAttributes() == other-&gt;textAttributes());</span>
00151 <span class="comment">    qDebug() &lt;&lt; (labels()         == other-&gt;labels());</span>
00152 <span class="comment">    qDebug() &lt;&lt; (shortLabels()    == other-&gt;shortLabels());</span>
00153 <span class="comment">    */</span>
00154     <span class="keywordflow">return</span>  ( static_cast&lt;const AbstractAreaBase*&gt;(<span class="keyword">this</span>)-&gt;compare( other ) ) &amp;&amp;
00155             (textAttributes() == other-&gt;textAttributes()) &amp;&amp;
00156             (labels()         == other-&gt;labels()) &amp;&amp;
00157             (shortLabels()    == other-&gt;shortLabels());
00158 }
00159 
00160 
<a name="l00161"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa10">00161</a> <span class="keyword">const</span> QString <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa10">AbstractAxis::customizedLabel</a>( <span class="keyword">const</span> QString&amp; label )<span class="keyword">const</span>
00162 {
00163     <span class="keywordflow">return</span> label;
00164 }
00165 
00166 
<a name="l00177"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa9">00177</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa9">AbstractAxis::createObserver</a>( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* diagram )
00178 {
00179     <span class="keywordflow">if</span>( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;setDiagram( diagram ) )
00180         <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa7">connectSignals</a>();
00181 }
00182 
<a name="l00193"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa11">00193</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa11">AbstractAxis::deleteObserver</a>( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a>* diagram )
00194 {
00195     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;unsetDiagram( diagram );
00196 }
00197 
<a name="l00211"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa7">00211</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa7">AbstractAxis::connectSignals</a>()
00212 {
00213     <span class="keywordflow">if</span>( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;observer ){
00214         connect( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;observer, SIGNAL( diagramDataChanged( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a> *) ),
00215                 <span class="keyword">this</span>, SLOT( update() ) );
00216     }
00217 }
00218 
00219 
<a name="l00231"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa46">00231</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa46">AbstractAxis::setTextAttributes</a>( <span class="keyword">const</span> <a class="code" href="class_k_d_chart_1_1_text_attributes.html">TextAttributes</a> &amp;a )
00232 {
00233     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;textAttributes = a;
00234 }
00235 
<a name="l00241"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa52">00241</a> <a class="code" href="class_k_d_chart_1_1_text_attributes.html">TextAttributes</a> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa52">AbstractAxis::textAttributes</a>()<span class="keyword"> const</span>
00242 <span class="keyword"></span>{
00243     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;textAttributes;
00244 }
00245 
<a name="l00263"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa41">00263</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa41">AbstractAxis::setLabels</a>( <span class="keyword">const</span> QStringList&amp; list )
00264 {
00265     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;hardLabels = list;
00266 }
00267 
<a name="l00273"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa21">00273</a> QStringList <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa21">AbstractAxis::labels</a>()<span class="keyword"> const</span>
00274 <span class="keyword"></span>{
00275     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;hardLabels;
00276 }
00277 
<a name="l00289"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa45">00289</a> <span class="keywordtype">void</span> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa45">AbstractAxis::setShortLabels</a>( <span class="keyword">const</span> QStringList&amp; list )
00290 {
00291     <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;hardShortLabels = list;
00292 }
00293 
<a name="l00302"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa49">00302</a> QStringList <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa49">AbstractAxis::shortLabels</a>()<span class="keyword"> const</span>
00303 <span class="keyword"></span>{
00304     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;hardShortLabels;
00305 }
00306 
<a name="l00312"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa8">00312</a> <span class="keyword">const</span> <a class="code" href="class_k_d_chart_1_1_abstract_coordinate_plane.html">AbstractCoordinatePlane</a>* <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa8">AbstractAxis::coordinatePlane</a>()<span class="keyword"> const</span>
00313 <span class="keyword"></span>{
00314     <span class="keywordflow">if</span>( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;diagram() )
00315         <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;diagram()-&gt;coordinatePlane();
00316     <span class="keywordflow">return</span> 0;
00317 }
00318 
<a name="l00319"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa12">00319</a> <span class="keyword">const</span> <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a> * <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa12">KDChart::AbstractAxis::diagram</a>()<span class="keyword"> const</span>
00320 <span class="keyword"></span>{
00321     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;diagram();
00322 }
00323 
<a name="l00324"></a><a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa26">00324</a> <span class="keywordtype">bool</span> <a class="code" href="class_k_d_chart_1_1_abstract_axis.html#_k_d_chart_1_1_cartesian_axisa26">KDChart::AbstractAxis::observedBy</a>( <a class="code" href="class_k_d_chart_1_1_abstract_diagram.html">AbstractDiagram</a> * diagram )<span class="keyword"> const</span>
00325 <span class="keyword"></span>{
00326     <span class="keywordflow">return</span> <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;hasDiagram( diagram );
00327 }
00328 
00329 <span class="keywordtype">void</span> KDChart::AbstractAxis::update()
00330 {
00331     <span class="keywordflow">if</span>( <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;diagram() )
00332         <a class="code" href="_k_d_chart_abstract_area_8cpp.html#a0">d</a>-&gt;diagram()-&gt;update();
00333 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu May 10 11:06:24 2007 for KD Chart 2 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > </a>1.3.6 </small></address>
</body>
</html>
